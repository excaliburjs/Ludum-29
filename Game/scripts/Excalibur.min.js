var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},ex;(function(n){var t=function(){function t(n,t){this.x=n;this.y=t}return t.prototype.toVector=function(){return new i(this.x,this.y)},t.prototype.rotate=function(i,r){r||(r=new n.Point(0,0));var u=(this.x-r.x)*Math.cos(i)+r.x,f=(this.y-r.y)*Math.sin(i)+r.y;return new t(u,f)},t.prototype.add=function(n){return new t(this.x+n.x,this.y+n.y)},t}(),i,r,u,f;n.Point=t;i=function(n){function i(t,i){n.call(this,t,i);this.x=t;this.y=i}return __extends(i,n),i.fromAngle=function(n){return new i(Math.cos(n),Math.sin(n))},i.prototype.distance=function(n){return n||(n=new i(0,0)),Math.sqrt(Math.pow(this.x-n.x,2)+Math.pow(this.y-n.y,2))},i.prototype.normalize=function(){var n=this.distance();return n>0?new i(this.x/n,this.y/n):new i(0,1)},i.prototype.scale=function(n){return new i(this.x*n,this.y*n)},i.prototype.add=function(n){return new i(this.x+n.x,this.y+n.y)},i.prototype.minus=function(n){return new i(this.x-n.x,this.y-n.y)},i.prototype.dot=function(n){return this.x*n.x+this.y*n.y},i.prototype.cross=function(n){return this.x*n.y-this.y*n.x},i.prototype.perpendicular=function(){return new i(this.y,-this.x)},i.prototype.normal=function(){return this.perpendicular().normalize()},i.prototype.toAngle=function(){return Math.atan2(this.y,this.x)},i.prototype.toPoint=function(){return new t(this.x,this.y)},i.prototype.rotate=function(t,i){return n.prototype.rotate.call(this,t,i).toVector()},i}(t);n.Vector=i;r=function(){function n(n,t){this.pos=n;this.dir=t.normalize()}return n.prototype.intersect=function(n){var i=n.begin.toVector().minus(this.pos.toVector()),t,r,u;return this.dir.cross(n.getSlope())===0&&i.cross(this.dir)!==0?-1:(t=this.dir.cross(n.getSlope()),t===0)?-1:(r=i.cross(n.getSlope())/t,r>=0&&(u=i.cross(this.dir)/t/n.getLength(),u>=0&&u<=1))?r:-1},n.prototype.getPoint=function(n){return this.pos.toVector().add(this.dir.scale(n)).toPoint()},n}();n.Ray=r;u=function(){function n(n,t){this.begin=n;this.end=t}return n.prototype.getSlope=function(){var n=this.begin.toVector(),t=this.end.toVector(),i=n.distance(t);return t.minus(n).scale(1/i)},n.prototype.getLength=function(){var n=this.begin.toVector(),t=this.end.toVector();return n.distance(t)},n}();n.Line=u;f=function(){function n(n,t){this.min=n;this.max=t}return n.prototype.overlaps=function(n){return this.max>n.min&&n.max>this.min},n.prototype.getOverlap=function(n){return this.overlaps(n)?this.max>n.max?n.max-this.min:this.max-n.min:0},n}();n.Projection=f})(ex||(ex={}));typeof window=="undefined"&&(window={audioContext:function(){}});typeof window=="undefined"||window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(n){window.setInterval(n,1e3/60)});typeof window=="undefined"||window.AudioContext||(window.AudioContext=window.webkitAudioContext||window.mozAudioContext);Array.prototype.some||(Array.prototype.some=function(n){"use strict";var i,r,u,t;if(this===void 0||this===null)throw new TypeError;if(i=Object(this),r=i.length>>>0,typeof n!="function")throw new TypeError;for(u=arguments.length>=2?arguments[1]:void 0,t=0;t<r;t++)if(t in i&&n.call(u,i[t],t,i))return!0;return!1}),function(n){var t,r,i,u;(function(n){n[n.Debug=0]="Debug";n[n.Info=1]="Info";n[n.Warn=2]="Warn";n[n.Error=3]="Error";n[n.Fatal=4]="Fatal"})(n.LogLevel||(n.LogLevel={}));t=n.LogLevel;r=function(){function n(){if(this.appenders=[],this.defaultLevel=1,n._instance)throw new Error("Logger is a singleton");return n._instance=this,n._instance.addAppender(new i),n._instance}return n.getInstance=function(){return n._instance==null&&(n._instance=new n),n._instance},n.prototype.addAppender=function(n){this.appenders.push(n)},n.prototype.clearAppenders=function(){this.appenders.length=0},n.prototype._log=function(n,t){var i=this;n==null&&(n=this.defaultLevel);this.appenders.forEach(function(r){n>=i.defaultLevel&&r.log(n,t)})},n.prototype.debug=function(){for(var t=[],n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];this._log(0,t)},n.prototype.info=function(){for(var t=[],n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];this._log(1,t)},n.prototype.warn=function(){for(var t=[],n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];this._log(2,t)},n.prototype.error=function(){for(var t=[],n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];this._log(3,t)},n.prototype.fatal=function(){for(var t=[],n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];this._log(4,t)},n._instance=null,n}();n.Logger=r;i=function(){function n(){}return n.prototype.log=function(n,i){var r=[];r.unshift.apply(r,i);r.unshift("["+t[n]+"] : ");n<2?console.log.apply(console,r):n<3?console.warn.apply(console,r):console.error.apply(console,r)},n}();n.ConsoleAppender=i;u=function(){function n(n,t){this._messages=[];this.canvas=document.createElement("canvas");this.canvas.width=n||window.innerWidth;this.canvas.height=t||window.innerHeight;this.canvas.style.position="absolute";this.ctx=this.canvas.getContext("2d");document.body.appendChild(this.canvas)}return n.prototype.log=function(n,i){var e=i.join(","),f,r,u;for(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this._messages.unshift("["+t[n]+"] : "+e),f=10,r=1,u=0;u<this._messages.length;u++)this.ctx.fillStyle="rgba(255,255,255,"+r.toFixed(2)+")",this.ctx.fillText(this._messages[u],200,f),f+=10,r=r>0?r-.05:0},n}();n.ScreenAppender=u}(ex||(ex={})),function(n){(function(t){function u(n){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="",i=0;i<n.length;){var s=n.charCodeAt(i++)&255,r=n.charCodeAt(i++)&255,u=n.charCodeAt(i++)&255,h=s>>2,c=(s&3)<<4|r>>4,f,e;isNaN(r)?f=e=64:(f=(r&15)<<2|u>>6,e=isNaN(u)?64:u&63);o+=t.charAt(h)+t.charAt(c)+t.charAt(f)+t.charAt(e)}return o}function f(n,t,i){return n<=t?t:n>=i?i:n}function e(n){if(n<0){var t=Math.floor(Math.abs(n)/(Math.PI*2))+1;n+=Math.PI*2*t}return n%(Math.PI*2)}function o(n,t,i,r,u,f){n.beginPath();n.strokeStyle=t;n.moveTo(i,r);n.lineTo(u,f);n.closePath();n.stroke()}function s(n,t){return n+Math.random()*(t-n)}function h(t){var i=0,r=0,u=function(n){i+=n.offsetLeft;n.offsetParent&&u(n.offsetParent)},f=function(n){r+=n.offsetTop;n.offsetParent&&f(n.offsetParent)};return u(t),f(t),new n.Point(i,r)}function c(n){return n===1?2:n===2?1:n===3?4:n===4?3:0}var r=function(){function t(){this.eventDispatcher=new n.EventDispatcher(this)}return t.prototype.addEventListener=function(n,t){this.eventDispatcher.subscribe(n,t)},t.prototype.removeEventListener=function(n,t){this.eventDispatcher.unsubscribe(n,t)},t.prototype.on=function(n,t){this.eventDispatcher.subscribe(n,t)},t.prototype.off=function(n,t){this.eventDispatcher.unsubscribe(n,t)},t.extend=function(n){var f=this,i,u,r;if(i=n&&n.hasOwnProperty("constructor")?n.constructor:function(){return f.apply(this,arguments)},u=function(){this.constructor=i},u.prototype=f.prototype,i.prototype=new u,n)for(r in n)n.hasOwnProperty(r)&&(i.prototype[r]=n[r]);return i.extend=t.extend,i},t}(),i;t.Class=r;t.base64Encode=u;t.clamp=f;t.canonicalizeAngle=e;t.drawLine=o;t.randomInRange=s;t.getPosition=h;t.getOppositeSide=c;i=function(){function n(t){this.internalArray=null;this.endPointer=0;var i=t||n.DefaultSize;this.internalArray=new Array(i)}return n.prototype.resize=function(){for(var i=this.internalArray.length*2,t=new Array(i),r=this.count(),n=0;n<r;n++)t[n]=this.internalArray[n];delete this.internalArray;this.internalArray=t},n.prototype.push=function(n){return this.endPointer===this.internalArray.length&&this.resize(),this.internalArray[this.endPointer++]=n},n.prototype.pop=function(){return this.endPointer=this.endPointer-1<0?0:this.endPointer-1,this.internalArray[this.endPointer]},n.prototype.count=function(){return this.endPointer},n.prototype.clear=function(){this.endPointer=0},n.prototype.internalSize=function(){return this.internalArray.length},n.prototype.elementAt=function(n){if(!(n>=this.count()))return this.internalArray[n]},n.prototype.insert=function(n,t){return n>=this.count()&&this.resize(),this.internalArray[n]=t},n.prototype.remove=function(n){var i=this.count(),r,t;if(i!==0){for(r=this.internalArray[n],t=n;t<i;t++)this.internalArray[t]=this.internalArray[t+1];return this.endPointer--,r}},n.prototype.removeElement=function(n){var t=this.internalArray.indexOf(n);this.remove(t)},n.prototype.toArray=function(){return this.internalArray.slice(0,this.endPointer)},n.prototype.forEach=function(n){for(var i=this.count(),t=0;t<i;t++)n.call(this,this.internalArray[t],t)},n.prototype.map=function(n){for(var i=this.count(),t=0;t<i;t++)this.internalArray[t]=n.call(this,this.internalArray[t],t)},n.DefaultSize=200,n}();t.Collection=i})(n.Util||(n.Util={}));var t=n.Util}(ex||(ex={})),function(n){var r=function(){function n(n,t){this.spriteSheetKey=n;this.spriteId=t}return n}(),t,i;n.TileSprite=r;t=function(){function t(t,i,r,u,f,e,o){typeof e=="undefined"&&(e=!1);typeof o=="undefined"&&(o=[]);this.x=t;this.y=i;this.width=r;this.height=u;this.index=f;this.solid=e;this.sprites=o;this._bounds=new n.BoundingBox(this.x,this.y,this.x+this.width,this.y+this.height)}return t.prototype.getBounds=function(){return this._bounds},t.prototype.getCenter=function(){return new n.Vector(this.x+this.width/2,this.y+this.height/2)},t.prototype.pushSprite=function(n){this.sprites.push(n)},t}();n.Cell=t;i=function(){function i(i,r,u,f,e,o){var c=this,s,h;for(this.x=i,this.y=r,this.cellWidth=u,this.cellHeight=f,this.rows=e,this.cols=o,this._collidingX=-1,this._collidingY=-1,this._onScreenXStart=0,this._onScreenXEnd=9999,this._onScreenYStart=0,this._onScreenYEnd=9999,this._spriteSheets={},this.logger=n.Logger.getInstance(),this.data=[],this.data=new Array(e*o),s=0;s<o;s++)for(h=0;h<e;h++)(function(){var n=new t(s*u+i,h*f+r,u,f,s+h*o);c.data[s+h*o]=n})()}return i.prototype.registerSpriteSheet=function(n,t){this._spriteSheets[n]=t},i.prototype.collides=function(t){for(var i,u,o,s=t.x+t.getWidth(),h=t.y+t.getHeight(),c=t.getBounds(),f=[],e=t.x;e<=s;e+=Math.min(t.getWidth()/2,this.cellWidth/2))for(i=t.y;i<=h;i+=Math.min(t.getHeight()/2,this.cellHeight/2)){var r=this.getCellByPoint(e,i);r&&r.solid&&(u=c.collides(r.getBounds()),o=t.getCenter().minus(r.getCenter()),u&&u.dot(o)>0&&f.push(u))}return f.length===0?null:f.reduce(function(t,i){var r=t.x,u=t.y;return Math.abs(t.x)<Math.abs(i.x)&&(r=i.x),Math.abs(t.y)<Math.abs(i.y)&&(u=i.y),new n.Vector(r,u)})},i.prototype.getCellByIndex=function(n){return this.data[n]},i.prototype.getCell=function(n,t){return n<0||t<0||n>=this.cols||t>=this.rows?null:this.data[n+t*this.cols]},i.prototype.getCellByPoint=function(n,t){var n=Math.floor((n-this.x)/this.cellWidth),t=Math.floor((t-this.y)/this.cellHeight),i=this.getCell(n,t);return n>=0&&t>=0&&n<this.cols&&t<this.rows&&i?i:null},i.prototype.update=function(t){var i=t.screenToWorldCoordinates(new n.Point(0,0)),r=t.screenToWorldCoordinates(new n.Point(t.width,t.height));this._onScreenXStart=Math.max(Math.floor(i.x/this.cellWidth)-2,0);this._onScreenYStart=Math.max(Math.floor((i.y-this.y)/this.cellHeight)-2,0);this._onScreenXEnd=Math.max(Math.floor(r.x/this.cellWidth)+2,0);this._onScreenYEnd=Math.max(Math.floor((r.y-this.y)/this.cellHeight)+2,0)},i.prototype.draw=function(n){var t=this,i,r;for(n.save(),n.translate(this.x,this.y),i=this._onScreenXStart;i<Math.min(this._onScreenXEnd,this.cols);i++)for(r=this._onScreenYStart;r<Math.min(this._onScreenYEnd,this.rows);r++)this.getCell(i,r).sprites.filter(function(n){return n.spriteId>-1}).forEach(function(u){var f=t._spriteSheets[u.spriteSheetKey],e;f?(e=f.getSprite(u.spriteId),e?e.draw(n,i*t.cellWidth,r*t.cellHeight):t.logger.warn("Sprite does not exist for id",u.spriteId,"in sprite sheet",u.spriteSheetKey,e,f)):t.logger.warn("Sprite sheet",u.spriteSheetKey,"does not exist",f)});n.restore()},i.prototype.debugDraw=function(t){var f=this.cols*this.cellWidth,e=this.rows*this.cellHeight,i,r,u;for(t.save(),t.strokeStyle=n.Color.Red.toString(),i=0;i<this.cols+1;i++)t.beginPath(),t.moveTo(this.x+i*this.cellWidth,this.y),t.lineTo(this.x+i*this.cellWidth,this.y+e),t.stroke();for(r=0;r<this.rows+1;r++)t.beginPath(),t.moveTo(this.x,this.y+r*this.cellHeight),t.lineTo(this.x+f,this.y+r*this.cellHeight),t.stroke();u=n.Color.Red.clone();u.a=.3;this.data.filter(function(n){return n.solid}).forEach(function(n){t.fillStyle=u.toString();t.fillRect(n.x,n.y,n.width,n.height)});this._collidingY>-1&&this._collidingX>-1&&(t.fillStyle=n.Color.Cyan.toString(),t.fillRect(this.x+this._collidingX*this.cellWidth,this.y+this._collidingY*this.cellHeight,this.cellWidth,this.cellHeight));t.restore()},i}();n.TileMap=i}(ex||(ex={})),function(n){var r,i,t;(function(n){n[n.AxisAligned=0]="AxisAligned";n[n.SeparatingAxis=1]="SeparatingAxis"})(n.CollisionStrategy||(n.CollisionStrategy={}));r=n.CollisionStrategy;i=function(){function i(n,t,i,r){this.left=n;this.top=t;this.right=i;this.bottom=r}return i.prototype.getWidth=function(){return this.right-this.left},i.prototype.getHeight=function(){return this.bottom-this.top},i.prototype.contains=function(n){return this.left<n.x&&this.top<n.y&&this.bottom>n.y&&this.right>n.x},i.prototype.collides=function(t){var r,e,u,f;return t instanceof i?(r=t,e=new i(Math.min(this.left,r.left),Math.min(this.top,r.top),Math.max(this.right,r.right),Math.max(this.bottom,r.bottom)),e.getWidth()<r.getWidth()+this.getWidth()&&e.getHeight()<r.getHeight()+this.getHeight()?(u=0,u=this.right>=r.left&&this.right<=r.right?r.left-this.right:r.right-this.left,f=0,f=this.top<=r.bottom&&this.top>=r.top?r.bottom-this.top:r.top-this.bottom,Math.abs(u)<Math.abs(f)?new n.Vector(u,0):new n.Vector(0,f)):null):null},i.prototype.debugDraw=function(){},i.prototype.toSATBB=function(){return new t([new n.Point(this.left,this.top),new n.Point(this.right,this.top),new n.Point(this.right,this.bottom),new n.Point(this.left,this.bottom)])},i}();n.BoundingBox=i;t=function(){function t(n){this._points=n.map(function(n){return n.toVector()})}return t.prototype.toSATBB=function(){return this},t.prototype.getSides=function(){for(var i=[],r=this._points.length,t=0;t<r;t++)i.push(new n.Line(this._points[t],this._points[(t+1)%r]));return i},t.prototype.getAxes=function(){for(var t=[],i=this._points.length,n=0;n<i;n++)t.push(this._points[n].minus(this._points[(n+1)%i]).normal());return t},t.prototype.project=function(t){for(var i=[],u=this._points.length,r=0;r<u;r++)i.push(this._points[r].dot(t));return new n.Projection(Math.min.apply(Math,i),Math.max.apply(Math,i))},t.prototype.getWidth=function(){var n=this._points.reduce(function(n,t){return Math.min(n,t.x)},Infinity),t=this._points.reduce(function(n,t){return Math.max(n,t.x)},-Infinity);return t-n},t.prototype.getHeight=function(){var n=this._points.reduce(function(n,t){return Math.min(n,t.y)},Infinity),t=this._points.reduce(function(n,t){return Math.max(n,t.y)},-Infinity);return n-t},t.prototype.contains=function(t){var i=new n.Ray(t,new n.Vector(1,0)),r=this.getSides().reduce(function(n,t){return i.intersect(t)>=0?n+1:n},0);return r%2==0?!1:!0},t.prototype.collides=function(n){var e,i,u,f,r;if(n instanceof t){for(e=n,i=this.getAxes(),i=e.getAxes().concat(i),u=99999,f=null,r=0;r<i.length;r++){var s=this.project(i[r]),h=e.project(i[r]),o=s.getOverlap(h);if(o===0)return null;o<=u&&(u=o,f=i[r])}return f?f.normalize().scale(u):null}return null},t.prototype.debugDraw=function(t){t.beginPath();t.lineWidth=2;var i=this._points[0];t.moveTo(i.x,i.y);this._points.forEach(function(n){t.lineTo(n.x,n.y)});t.lineTo(i.x,i.y);t.closePath();t.strokeStyle=n.Color.Blue.toString();t.stroke()},t}();n.SATBoundingBox=t}(ex||(ex={})),function(n){var f=function(){function n(n,t){this.x=n;this.y=t}return n}(),i,e,o,t,s,h,r,u;n.Overlap=f;i=function(t){function i(){t.call(this);this.children=[];this.collisionMaps=[];this.killQueue=[];this.timers=[];this.cancelQueue=[];this._isInitialized=!1}return __extends(i,t),i.prototype.onActivate=function(){},i.prototype.onDeactivate=function(){},i.prototype.onInitialize=function(){},i.prototype.publish=function(n,t){this.children.forEach(function(i){i.triggerEvent(n,t)})},i.prototype.update=function(t,i){var u,f,e,s,o,r,h;if(!this._isInitialized){this.onInitialize(t);this.eventDispatcher.publish("initialize",new n.InitializeEvent(t));this._isInitialized=!0}this.collisionMaps.forEach(function(n){n.update(t,i)});this.eventDispatcher.update();var r=0;for(u=0,r=this.children.length;u<r;u++)this.children[u].update(t,i);for(f=0,e=0,r=this.killQueue.length;e<r;e++)f=this.children.indexOf(this.killQueue[e]),f>-1&&this.children.splice(f,1);for(this.killQueue.length=0,s=0,o=0,r=this.cancelQueue.length;o<r;o++)this.removeTimer(this.cancelQueue[o]);this.cancelQueue.length=0;h=this;this.timers=this.timers.filter(function(n){return n.update(i),!n.complete})},i.prototype.draw=function(n,t){var i,r;this.collisionMaps.forEach(function(i){i.draw(n,t)});var r=0,u;for(i=0,r=this.children.length;i<r;i++)u=this.children[i],this.children[i].draw(n,t)},i.prototype.debugDraw=function(n){this.collisionMaps.forEach(function(t){t.debugDraw(n)});this.children.forEach(function(t){t.debugDraw(n)})},i.prototype.addChild=function(n){n.scene=this;this.children.push(n);n.parent=this.actor},i.prototype.addTileMap=function(n){this.collisionMaps.push(n)},i.prototype.removeTileMap=function(n){var t=this.collisionMaps.indexOf(n);t>-1&&this.collisionMaps.splice(t,1)},i.prototype.removeChild=function(n){this.killQueue.push(n);n.parent=null},i.prototype.addTimer=function(n){return this.timers.push(n),n.scene=this,n},i.prototype.removeTimer=function(n){var t=this.timers.indexOf(n);return t!==-1&&this.timers.splice(t,1),n},i.prototype.cancelTimer=function(n){return this.cancelQueue.push(n),n},i.prototype.isTimerActive=function(n){return this.timers.indexOf(n)>-1},i}(n.Util.Class);n.Scene=i,function(n){n[n.None=0]="None";n[n.Top=1]="Top";n[n.Bottom=2]="Bottom";n[n.Left=3]="Left";n[n.Right=4]="Right"}(n.Side||(n.Side={}));e=n.Side,function(n){n[n.PreventCollision=0]="PreventCollision";n[n.Passive=1]="Passive";n[n.Active=2]="Active";n[n.Elastic=3]="Elastic";n[n.Fixed=4]="Fixed"}(n.CollisionType||(n.CollisionType={}));o=n.CollisionType;t=function(t){function r(r,u,f,e,o){t.call(this);this.x=0;this.y=0;this.height=0;this.width=0;this.rotation=0;this.rx=0;this.scaleX=1;this.scaleY=1;this.sx=0;this.sy=0;this.dx=0;this.dy=0;this.ax=0;this.ay=0;this.isOffScreen=!1;this.invisible=!1;this.opacity=1;this.previousOpacity=1;this.logger=n.Logger.getInstance();this.scene=null;this.parent=null;this.collisionType=2;this.collisionStrategy=0;this.collisionGroups=[];this._collisionHandlers={};this._isInitialized=!1;this.frames={};this.currentDrawing=null;this.centerDrawingX=!1;this.centerDrawingY=!1;this._isKilled=!1;this.x=r||0;this.y=u||0;this.width=f||0;this.height=e||0;this.color=o;this.actionQueue=new n.Internal.Actions.ActionQueue(this);this.sceneNode=new i;this.sceneNode.actor=this}return __extends(r,t),r.prototype.onInitialize=function(){},r.prototype.kill=function(){this.scene?(this.scene.removeChild(this),this._isKilled=!0):this.logger.warn("Cannot kill actor, it was never added to the Scene")},r.prototype.addChild=function(n){n.collisionType=0;this.sceneNode.addChild(n)},r.prototype.removeChild=function(n){this.sceneNode.removeChild(n)},r.prototype.setDrawing=function(n){this.currentDrawing!=this.frames[n]&&this.frames[n].reset();this.currentDrawing=this.frames[n]},r.prototype.addDrawing=function(n,t){this.frames[n]=t;this.currentDrawing||(this.currentDrawing=t)},r.prototype.triggerEvent=function(n,t){this.eventDispatcher.publish(n,t)},r.prototype.addCollisionGroup=function(n){this.collisionGroups.push(n)},r.prototype.removeCollisionGroup=function(n){var t=this.collisionGroups.indexOf(n);t!==-1&&this.collisionGroups.splice(t,1)},r.prototype.getCenter=function(){return new n.Vector(this.x+this.getWidth()/2,this.y+this.getHeight()/2)},r.prototype.getWidth=function(){return this.width*this.scaleX},r.prototype.setWidth=function(n){this.width=n/this.scaleX},r.prototype.getHeight=function(){return this.height*this.scaleY},r.prototype.setHeight=function(n){this.height=n/this.scaleY},r.prototype.setCenterDrawing=function(){this.centerDrawingY=!0;this.centerDrawingX=!0},r.prototype.getLeft=function(){return this.x},r.prototype.getRight=function(){return this.x+this.getWidth()},r.prototype.getTop=function(){return this.y},r.prototype.getBottom=function(){return this.y+this.getHeight()},r.prototype.getGlobalX=function(){for(var t,n=this.parent;n;)t=n,n=n.parent;return t?this.x+t.x:this.x},r.prototype.getGlobalY=function(){for(var t,n=this.parent;n;)t=n,n=n.parent;return t?this.y+t.y:this.y},r.prototype.getBounds=function(){if(this.collisionStrategy===1){var t=new n.Vector(this.x,this.y),i=new n.Point(0,0).add(t),r=new n.Point(this.getWidth(),0).add(t),u=new n.Point(this.getWidth(),this.getHeight()).add(t),f=new n.Point(0,this.getHeight()).add(t);return new n.SATBoundingBox([i,r,u,f])}return new n.BoundingBox(this.getGlobalX(),this.getGlobalY(),this.getGlobalX()+this.getWidth(),this.getGlobalY()+this.getHeight())},r.prototype.contains=function(t,i){return this.getBounds().contains(new n.Point(t,i))},r.prototype.getSideFromIntersect=function(n){return n?Math.abs(n.x)>Math.abs(n.y)?n.x>0?4:3:n.y>0?2:1:0},r.prototype.collidesWithSide=function(n){var t=this.collides(n);return t?Math.abs(t.x)>Math.abs(t.y)?this.x<n.x?4:3:this.y<n.y?2:1:0},r.prototype.collides=function(n){var t=this.getBounds(),i=n.getBounds();return t.collides(i)},r.prototype.onCollidesWith=function(n,t){this._collisionHandlers[n]||(this._collisionHandlers[n]=[]);this._collisionHandlers[n].push(t)},r.prototype.removeCollidesWith=function(n){this._collisionHandlers[n]=[]},r.prototype.within=function(n,t){return Math.sqrt(Math.pow(this.x-n.x,2)+Math.pow(this.y-n.y,2))<=t},r.prototype.clearActions=function(){this.actionQueue.clearActions()},r.prototype.moveTo=function(t,i,r){return this.actionQueue.add(new n.Internal.Actions.MoveTo(this,t,i,r)),this},r.prototype.moveBy=function(t,i,r){return this.actionQueue.add(new n.Internal.Actions.MoveBy(this,t,i,r)),this},r.prototype.rotateTo=function(t,i){return this.actionQueue.add(new n.Internal.Actions.RotateTo(this,t,i)),this},r.prototype.rotateBy=function(t,i){return this.actionQueue.add(new n.Internal.Actions.RotateBy(this,t,i)),this},r.prototype.scaleTo=function(t,i,r,u){return this.actionQueue.add(new n.Internal.Actions.ScaleTo(this,t,i,r,u)),this},r.prototype.scaleBy=function(t,i,r){return this.actionQueue.add(new n.Internal.Actions.ScaleBy(this,t,i,r)),this},r.prototype.blink=function(t,i,r){return this.actionQueue.add(new n.Internal.Actions.Blink(this,t,i,r)),this},r.prototype.fade=function(t,i){return this.actionQueue.add(new n.Internal.Actions.Fade(this,t,i)),this},r.prototype.delay=function(t){return this.actionQueue.add(new n.Internal.Actions.Delay(this,t)),this},r.prototype.die=function(){return this.actionQueue.add(new n.Internal.Actions.Die(this)),this},r.prototype.callMethod=function(t){return this.actionQueue.add(new n.Internal.Actions.CallMethod(this,t)),this},r.prototype.repeat=function(t){return t?(this.actionQueue.add(new n.Internal.Actions.Repeat(this,t,this.actionQueue.getActions())),this):(this.repeatForever(),this)},r.prototype.repeatForever=function(){return this.actionQueue.add(new n.Internal.Actions.RepeatForever(this,this.actionQueue.getActions())),this},r.prototype.follow=function(t,i){return i==undefined?this.actionQueue.add(new n.Internal.Actions.Follow(this,t)):this.actionQueue.add(new n.Internal.Actions.Follow(this,t,i)),this},r.prototype.meet=function(t,i){return i==undefined?this.actionQueue.add(new n.Internal.Actions.Meet(this,t)):this.actionQueue.add(new n.Internal.Actions.Meet(this,t,i)),this},r.prototype.update=function(t,i){var f=this,r,v,l,o,u,s,a,e,h;if(!this._isInitialized){this.onInitialize(t);this.eventDispatcher.publish("initialize",new n.InitializeEvent(t));this._isInitialized=!0}if(!this._isKilled){if(this.sceneNode.update(t,i),r=this.eventDispatcher,r.update(),this.actionQueue.update(i),this.x+=this.dx*i/1e3,this.y+=this.dy*i/1e3,this.dx+=this.ax*i/1e3,this.dy+=this.ay*i/1e3,this.rotation+=this.rx*i/1e3,this.scaleX+=this.sx*i/1e3,this.scaleY+=this.sy*i/1e3,this.collisionType!==0){for(v=t.currentScene.children.filter(function(n){return!n._isKilled&&n.collisionType!==0&&f!==n}),l=0;l<v.length;l++)s=v[l],(o=this.collides(s))&&(u=this.getSideFromIntersect(o),r.publish("collision",new n.CollisionEvent(this,s,u,o)),s.eventDispatcher.publish("collision",new n.CollisionEvent(s,this,n.Util.getOppositeSide(u),o.scale(-1))),s.collisionGroups.forEach(function(n){f._collisionHandlers[n]&&f._collisionHandlers[n].forEach(function(n){n.call(f,s)})}),(this.collisionType===2||this.collisionType===3)&&s.collisionType!==1&&(this.collisionStrategy===1?(this.x+=o.x,this.y+=o.y):(this.y+=o.y,this.x+=o.x),this.collisionType===3&&(u===3?this.dx=Math.abs(this.dx):u===4?this.dx=-Math.abs(this.dx):u===1?this.dy=Math.abs(this.dy):u===2&&(this.dy=-Math.abs(this.dy)))));for(a=0;a<t.currentScene.collisionMaps.length;a++)for(var p=t.currentScene.collisionMaps[a],c,u=0,w=2,y=!1;c=p.collides(this);){if(w--<0)break;u=this.getSideFromIntersect(c);r.publish("collision",new n.CollisionEvent(this,null,u,c));(this.collisionType===2||this.collisionType===3)&&(this.y+=c.y,this.x+=c.x,this.collisionType!==3||y||(y=!0,u===3?this.dx=Math.abs(this.dx):u===4?this.dx=-Math.abs(this.dx):u===1?this.dy=Math.abs(this.dy):u===2&&(this.dy=-Math.abs(this.dy))))}}t.keys.forEach(function(t){r.publish(n.InputKey[t],new n.KeyEvent(t))});t.clicks.forEach(function(t){f.contains(t.x,t.y)&&(r.publish(n.EventType[10],new n.Click(t.x,t.y,t.mouseEvent)),r.publish(n.EventType[3],new n.MouseDown(t.x,t.y,t.mouseEvent)))});t.mouseMove.forEach(function(t){f.contains(t.x,t.y)&&r.publish(n.EventType[4],new n.MouseMove(t.x,t.y,t.mouseEvent))});t.mouseUp.forEach(function(t){f.contains(t.x,t.y)&&r.publish(n.EventType[5],new n.MouseUp(t.x,t.y,t.mouseEvent))});t.touchStart.forEach(function(t){f.contains(t.x,t.y)&&r.publish(n.EventType[6],new n.TouchStart(t.x,t.y))});t.touchMove.forEach(function(t){f.contains(t.x,t.y)&&r.publish(n.EventType[7],new n.TouchMove(t.x,t.y))});t.touchEnd.forEach(function(t){f.contains(t.x,t.y)&&r.publish(n.EventType[8],new n.TouchEnd(t.x,t.y))});t.touchCancel.forEach(function(t){f.contains(t.x,t.y)&&r.publish(n.EventType[9],new n.TouchCancel(t.x,t.y))});e=t.worldToScreenCoordinates(new n.Point(this.getGlobalX(),this.getGlobalY()));h=1;t.camera&&(h=t.camera.getZoom());this.isOffScreen?e.x+this.getWidth()*h>0&&e.y+this.getHeight()*h>0&&e.x<t.width&&e.y<t.height&&(r.publish("enterviewport",new n.EnterViewPortEvent),this.isOffScreen=!1):(e.x+this.getWidth()*h<0||e.y+this.getHeight()*h<0||e.x>t.width||e.y>t.height)&&(r.publish("exitviewport",new n.ExitViewPortEvent),this.isOffScreen=!0);r.publish(n.EventType[16],new n.UpdateEvent(i))}},r.prototype.draw=function(t,i){var f,r,u;if(!this.isOffScreen){if(t.save(),t.translate(this.x,this.y),this.previousOpacity!=this.opacity){for(f in this.frames)this.frames[f].addEffect(new n.Effects.Opacity(this.opacity));this.previousOpacity=this.opacity}this.invisible||(this.currentDrawing?(r=0,u=0,this.centerDrawingX&&(t.translate(this.getWidth()/2,0),r=this.currentDrawing.width/2*this.currentDrawing.getScaleX()),this.centerDrawingY&&(t.translate(0,this.getHeight()/2),u=this.currentDrawing.height/2*this.currentDrawing.getScaleY()),t.rotate(this.rotation),this.currentDrawing.draw(t,-r,-u)):(t.rotate(this.rotation),t.scale(this.scaleX,this.scaleY),this.color&&(this.color.a=this.opacity),t.fillStyle=this.color?this.color.toString():new n.Color(0,0,0).toString(),t.fillRect(0,0,this.width,this.height)));this.sceneNode.draw(t,i);t.restore()}},r.prototype.debugDraw=function(t){t.save();t.translate(this.x,this.y);t.fillStyle=n.Color.Yellow.toString();t.strokeStyle=n.Color.Yellow.toString();t.beginPath();t.rect(0,0,this.getWidth(),this.getHeight());t.stroke();this.sceneNode.debugDraw(t);t.restore();this.getBounds().debugDraw(t)},r}(n.Util.Class);n.Actor=t,function(n){n[n.Left=0]="Left";n[n.Right=1]="Right";n[n.Center=2]="Center";n[n.Start=3]="Start";n[n.End=4]="End"}(n.TextAlign||(n.TextAlign={}));s=n.TextAlign,function(n){n[n.Top=0]="Top";n[n.Hanging=1]="Hanging";n[n.Middle=2]="Middle";n[n.Alphabetic=3]="Alphabetic";n[n.Ideographic=4]="Ideographic";n[n.Bottom=5]="Bottom"}(n.BaseAlign||(n.BaseAlign={}));h=n.BaseAlign;r=function(t){function i(i,r,u,f,e){t.call(this,r,u);this.letterSpacing=0;this.caseInsensitive=!0;this._textShadowOn=!1;this._shadowOffsetX=0;this._shadowOffsetY=0;this._shadowColor=n.Color.Black.clone();this._shadowColorDirty=!1;this._textSprites={};this._shadowSprites={};this._color=n.Color.Black.clone();this.text=i||"";this.color=n.Color.Black.clone();this.spriteFont=e;this.collisionType=0;this.font=f||"10px sans-serif";e&&(this._textSprites=e.getTextSprites())}return __extends(i,t),i.prototype.getTextWidth=function(n){var i=n.font,t;return n.font=this.font,t=n.measureText(this.text).width,n.font=i,t},i.prototype._lookupTextAlign=function(n){switch(n){case 0:return"left";case 1:return"right";case 2:return"center";case 4:return"end";case 3:return"start";default:return"start"}},i.prototype._lookupBaseAlign=function(n){switch(n){case 3:return"alphabetic";case 5:return"bottom";case 1:return"hangin";case 4:return"ideographic";case 2:return"middle";case 0:return"top";default:return"alphabetic"}},i.prototype.setTextShadow=function(n,t,i){this._textShadowOn=!0;this._shadowOffsetX=n;this._shadowOffsetY=t;this._shadowColor=i.clone();this._shadowColorDirty=!0;for(var r in this._textSprites)this._shadowSprites[r]=this._textSprites[r].clone()},i.prototype.clearTextShadow=function(){this._textShadowOn=!1;this._shadowOffsetX=0;this._shadowOffsetY=0;this._shadowColor=n.Color.Black.clone()},i.prototype.update=function(i,r){var u;if(t.prototype.update.call(this,i,r),this.spriteFont&&this._color!==this.color)for(u in this._textSprites)this._textSprites[u].clearEffects(),this._textSprites[u].addEffect(new n.Effects.Fill(this.color.clone())),this._color=this.color;if(this.spriteFont&&this._textShadowOn&&this._shadowColorDirty&&this._shadowColor){for(u in this._shadowSprites)this._shadowSprites[u].clearEffects(),this._shadowSprites[u].addEffect(new n.Effects.Fill(this._shadowColor.clone()));this._shadowColorDirty=!1}},i.prototype.draw=function(n,i){n.save();n.translate(this.x,this.y);n.scale(this.scaleX,this.scaleY);n.rotate(this.rotation);this._textShadowOn&&(n.save(),n.translate(this._shadowOffsetX,this._shadowOffsetY),this._fontDraw(n,i,this._shadowSprites),n.restore());this._fontDraw(n,i,this._textSprites);t.prototype.draw.call(this,n,i);n.restore()},i.prototype._fontDraw=function(t,i,r){var o,e,u,f,s,h;if(!this.invisible)if(this.spriteFont){for(o=0,e=0;e<this.text.length;e++){u=this.text[e];this.caseInsensitive&&(u=u.toLowerCase());try{f=r[u];this.previousOpacity!==this.opacity&&(f.clearEffects(),f.addEffect(new n.Effects.Opacity(this.opacity)));f.draw(t,o,0);o+=f.swidth+this.letterSpacing}catch(c){n.Logger.getInstance().error("SpriteFont Error drawing char "+u)}}this.previousOpacity!==this.opacity&&(this.previousOpacity=this.opacity)}else s=t.textAlign,h=t.textBaseline,t.textAlign=this._lookupTextAlign(this.textAlign),t.textBaseline=this._lookupBaseAlign(this.baseAlign),this.color&&(this.color.a=this.opacity),t.fillStyle=this.color.toString(),t.font=this.font,this.maxWidth?t.fillText(this.text,0,0,this.maxWidth):t.fillText(this.text,0,0),t.textAlign=s,t.textBaseline=h},i.prototype.debugDraw=function(n){t.prototype.debugDraw.call(this,n)},i}(t);n.Label=r;u=function(t){function i(i,r,u,f,e,o){t.call(this,i,r,u,f);this.action=function(){};this.repeats=1;this.target=null;this.repeats=o||this.repeats;this.action=e||this.action;this.collisionType=0;this.eventDispatcher=new n.EventDispatcher(this);this.actionQueue=new n.Internal.Actions.ActionQueue(this)}return __extends(i,t),i.prototype.update=function(n,t){var u=this.eventDispatcher,i,r;if(u.update(),this.actionQueue.update(t),this.x+=this.dx*t/1e3,this.y+=this.dy*t/1e3,this.rotation+=this.rx*t/1e3,this.scaleX+=this.sx*t/1e3,this.scaleY+=this.sy*t/1e3,this.target)this.collides(this.target)&&this.dispatchAction();else for(i=0;i<n.currentScene.children.length;i++)r=n.currentScene.children[i],r!==this&&r.collisionType!==0&&this.collides(r)&&this.dispatchAction();this.repeats===0&&this.kill()},i.prototype.dispatchAction=function(){this.action.call(this);this.repeats--},i.prototype.draw=function(){return},i.prototype.debugDraw=function(i){t.prototype.debugDraw.call(this,i);i.save();i.translate(this.x,this.y);i.fillStyle=n.Color.Violet.toString();i.strokeStyle=n.Color.Violet.toString();i.fillText("Trigger",10,10);i.beginPath();i.rect(0,0,this.getWidth(),this.getHeight());i.stroke();i.restore()},i}(t);n.Trigger=u}(ex||(ex={})),function(n){var rt,t,i,r,u,f,e,o,s,h,c,l,a,v,y,ut,p,w,b,k,d,g,nt,tt,it;(function(n){n[n.KeyDown=0]="KeyDown";n[n.KeyUp=1]="KeyUp";n[n.KeyPress=2]="KeyPress";n[n.MouseDown=3]="MouseDown";n[n.MouseMove=4]="MouseMove";n[n.MouseUp=5]="MouseUp";n[n.TouchStart=6]="TouchStart";n[n.TouchMove=7]="TouchMove";n[n.TouchEnd=8]="TouchEnd";n[n.TouchCancel=9]="TouchCancel";n[n.Click=10]="Click";n[n.Collision=11]="Collision";n[n.EnterViewPort=12]="EnterViewPort";n[n.ExitViewPort=13]="ExitViewPort";n[n.Blur=14]="Blur";n[n.Focus=15]="Focus";n[n.Update=16]="Update";n[n.Activate=17]="Activate";n[n.Deactivate=18]="Deactivate";n[n.Initialize=19]="Initialize"})(n.EventType||(n.EventType={}));rt=n.EventType;t=function(){function n(){}return n}();n.GameEvent=t;i=function(n){function t(){n.call(this)}return __extends(t,n),t}(t);n.FocusEvent=i;r=function(n){function t(){n.call(this)}return __extends(t,n),t}(t);n.BlurEvent=r;u=function(n){function t(t,i,r,u){n.call(this);this.actor=t;this.other=i;this.side=r;this.intersection=u}return __extends(t,n),t}(t);n.CollisionEvent=u;f=function(n){function t(t){n.call(this);this.delta=t}return __extends(t,n),t}(t);n.UpdateEvent=f;e=function(n){function t(t){n.call(this);this.engine=t}return __extends(t,n),t}(t);n.InitializeEvent=e;o=function(n){function t(t){n.call(this);this.oldScene=t}return __extends(t,n),t}(t);n.ActivateEvent=o;s=function(n){function t(t){n.call(this);this.newScene=t}return __extends(t,n),t}(t);n.DeactivateEvent=s;h=function(n){function t(){n.call(this)}return __extends(t,n),t}(t);n.ExitViewPortEvent=h;c=function(n){function t(){n.call(this)}return __extends(t,n),t}(t);n.EnterViewPortEvent=c;l=function(n){function t(t){n.call(this);this.key=t}return __extends(t,n),t}(t);n.KeyEvent=l;a=function(n){function t(t){n.call(this);this.key=t}return __extends(t,n),t}(t);n.KeyDown=a;v=function(n){function t(t){n.call(this);this.key=t}return __extends(t,n),t}(t);n.KeyUp=v;y=function(n){function t(t){n.call(this);this.key=t}return __extends(t,n),t}(t);n.KeyPress=y,function(n){n[n.Left=0]="Left";n[n.Middle=1]="Middle";n[n.Right=2]="Right"}(n.MouseButton||(n.MouseButton={}));ut=n.MouseButton;p=function(n){function t(t,i,r){n.call(this);this.x=t;this.y=i;this.mouseEvent=r}return __extends(t,n),t}(t);n.MouseDown=p;w=function(n){function t(t,i,r){n.call(this);this.x=t;this.y=i;this.mouseEvent=r}return __extends(t,n),t}(t);n.MouseMove=w;b=function(n){function t(t,i,r){n.call(this);this.x=t;this.y=i;this.mouseEvent=r}return __extends(t,n),t}(t);n.MouseUp=b;k=function(n){function t(t,i){n.call(this);this.x=t;this.y=i}return __extends(t,n),t}(t);n.TouchStart=k;d=function(n){function t(t,i){n.call(this);this.x=t;this.y=i}return __extends(t,n),t}(t);n.TouchMove=d;g=function(n){function t(t,i){n.call(this);this.x=t;this.y=i}return __extends(t,n),t}(t);n.TouchEnd=g;nt=function(n){function t(t,i){n.call(this);this.x=t;this.y=i}return __extends(t,n),t}(t);n.TouchCancel=nt;tt=function(n){function t(t,i,r){n.call(this);this.x=t;this.y=i;this.mouseEvent=r}return __extends(t,n),t}(t);n.Click=tt;it=function(){function i(t){this._handlers={};this.queue=[];this.log=n.Logger.getInstance();this.target=t}return i.prototype.publish=function(n,i){if(n){n=n.toLowerCase();var u=this.queue,r=this.target;i||(i=new t);i.target=r;this._handlers[n]&&this._handlers[n].forEach(function(n){u.push(function(){n.call(r,i)})})}},i.prototype.subscribe=function(n,t){var i=this,r=n.split(",").map(function(n){return n.toLowerCase().trim()});r.forEach(function(n){n=n.toLowerCase();i._handlers[n]||(i._handlers[n]=[]);i._handlers[n].push(t)})},i.prototype.unsubscribe=function(n,t){var i,r;n=n.toLowerCase();i=this._handlers[n];i&&(t?(r=i.indexOf(t),this._handlers[n].splice(r,1)):this._handlers[n].length=0)},i.prototype.update=function(){for(var n;n=this.queue.shift();)n()},i}();n.EventDispatcher=it}(ex||(ex={})),function(n){var r,t,i;(function(n){n[n.Circle=0]="Circle";n[n.Rectangle=1]="Rectangle"})(n.EmitterType||(n.EmitterType={}));r=n.EmitterType;t=function(){function t(t,i,r,u,f,e,o,s,h,c){this.position=new n.Vector(0,0);this.velocity=new n.Vector(0,0);this.acceleration=new n.Vector(0,0);this.focus=null;this.focusAccel=0;this.opacity=1;this.beginColor=n.Color.White.clone();this.endColor=n.Color.White.clone();this.life=300;this.fadeFlag=!1;this.rRate=1;this.gRate=1;this.bRate=1;this.aRate=0;this.currentColor=n.Color.White.clone();this.emitter=null;this.particleSize=5;this.particleSprite=null;this.sizeRate=0;this.elapsedMultiplier=0;this.emitter=t;this.life=i||this.life;this.opacity=r||this.opacity;this.endColor=f||this.endColor.clone();this.beginColor=u||this.beginColor.clone();this.currentColor=this.beginColor.clone();this.position=e||this.position;this.velocity=o||this.velocity;this.acceleration=s||this.acceleration;this.rRate=(this.endColor.r-this.beginColor.r)/this.life;this.gRate=(this.endColor.g-this.beginColor.g)/this.life;this.bRate=(this.endColor.b-this.beginColor.b)/this.life;this.aRate=this.opacity/this.life;this.startSize=h||0;this.endSize=c||0;this.endSize>0&&this.startSize>0&&(this.sizeRate=(this.endSize-this.startSize)/this.life,this.particleSize=this.startSize)}return t.prototype.kill=function(){this.emitter.removeParticle(this)},t.prototype.update=function(t){if(this.life=this.life-t,this.elapsedMultiplier=this.elapsedMultiplier+t,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=n.Util.clamp(this.aRate*this.life,.0001,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=n.Util.clamp(this.sizeRate*t+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this.currentColor.r=n.Util.clamp(this.currentColor.r+this.rRate*t,0,255),this.currentColor.g=n.Util.clamp(this.currentColor.g+this.gRate*t,0,255),this.currentColor.b=n.Util.clamp(this.currentColor.b+this.bRate*t,0,255),this.currentColor.a=n.Util.clamp(this.opacity,.0001,1),this.focus){var i=this.focus.minus(this.position).normalize().scale(this.focusAccel).scale(t/1e3);this.velocity=this.velocity.add(i)}else this.velocity=this.velocity.add(this.acceleration.scale(t/1e3));this.position=this.position.add(this.velocity.scale(t/1e3))},t.prototype.draw=function(t){if(this.particleSprite){this.particleSprite.draw(t,this.position.x,this.position.y);return}this.currentColor.a=n.Util.clamp(this.opacity,.0001,1);t.fillStyle=this.currentColor.toString();t.beginPath();t.arc(this.position.x,this.position.y,this.particleSize,0,Math.PI*2);t.fill();t.closePath()},t}();n.Particle=t;i=function(i){function r(t,r,u,f){i.call(this,t,r,u,f,n.Color.White);this.numParticles=0;this.isEmitting=!0;this.particles=null;this.deadParticles=null;this.minVel=0;this.maxVel=0;this.acceleration=new n.Vector(0,0);this.minAngle=0;this.maxAngle=0;this.emitRate=1;this.particleLife=2e3;this.opacity=1;this.fadeFlag=!1;this.focus=null;this.focusAccel=1;this.startSize=null;this.endSize=null;this.minSize=5;this.maxSize=5;this.beginColor=n.Color.White;this.endColor=n.Color.White;this.particleSprite=null;this.emitterType=1;this.radius=0;this.collisionType=0;this.particles=new n.Util.Collection;this.deadParticles=new n.Util.Collection}return __extends(r,i),r.prototype.removeParticle=function(n){this.deadParticles.push(n)},r.prototype.emit=function(n){for(var t=0;t<n;t++)this.particles.push(this.createParticle())},r.prototype.clearParticles=function(){this.particles.clear()},r.prototype.createParticle=function(){var u=0,f=0,r=n.Util.randomInRange(this.minAngle,this.maxAngle),o=n.Util.randomInRange(this.minVel,this.maxVel),s=this.startSize||n.Util.randomInRange(this.minSize,this.maxSize),h=o*Math.cos(r),c=o*Math.sin(r),e,i;return this.emitterType===1?(u=n.Util.randomInRange(this.x,this.x+this.getWidth()),f=n.Util.randomInRange(this.y,this.y+this.getHeight())):this.emitterType===0&&(e=n.Util.randomInRange(0,this.radius),u=e*Math.cos(r)+this.x,f=e*Math.sin(r)+this.y),i=new t(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new n.Vector(u,f),new n.Vector(h,c),this.acceleration,this.startSize,this.endSize),i.fadeFlag=this.fadeFlag,i.particleSize=s,i.particleSprite=this.particleSprite,this.focus&&(i.focus=this.focus.add(new n.Vector(this.x,this.y)),i.focusAccel=this.focusAccel),i},r.prototype.update=function(n,t){var u=this,r;i.prototype.update.call(this,n,t);this.isEmitting&&(r=Math.ceil(this.emitRate*t/1e3),this.emit(r));this.particles.forEach(function(n){n.update(t)});this.deadParticles.forEach(function(n){u.particles.removeElement(n)});this.deadParticles.clear()},r.prototype.draw=function(n){this.particles.forEach(function(t){t.draw(n)})},r.prototype.debugDraw=function(t){i.prototype.debugDraw.call(this,t);t.fillStyle=n.Color.Black.toString();t.fillText("Particles: "+this.particles.count(),this.x,this.y+20);this.focus&&(t.fillRect(this.focus.x+this.x,this.focus.y+this.y,3,3),n.Util.drawLine(t,"yellow",this.focus.x+this.x,this.focus.y+this.y,i.prototype.getCenter.call(this).x,i.prototype.getCenter.call(this).y),t.fillText("Focus",this.focus.x+this.x,this.focus.y+this.y))},r}(n.Actor);n.ParticleEmitter=i}(ex||(ex={})),function(n){(function(t){var f=function(){function t(t,u){this.log=n.Logger.getInstance();this.onload=function(){};this.onprogress=function(){};this.onerror=function(){};window.AudioContext?(this.log.debug("Using new Web Audio Api for "+t),this.soundImpl=new r(t,u)):(this.log.debug("Falling back to Audio Element for "+t),this.soundImpl=new i(t,u))}return t.prototype.setVolume=function(n){this.soundImpl.setVolume(n)},t.prototype.setLoop=function(n){this.soundImpl.setLoop(n)},t.prototype.load=function(){this.soundImpl.onload=this.onload;this.soundImpl.onprogress=this.onprogress;this.soundImpl.onerror=this.onerror;this.soundImpl.load()},t.prototype.play=function(){this.soundImpl.play()},t.prototype.stop=function(){this.soundImpl.stop()},t}(),i,u,r;t.FallbackAudio=f;i=function(){function t(t,i){var u=this,r;for(this.path=t,this.audioElements=new Array(5),this._loadedAudio=null,this.isLoaded=!1,this.index=0,this.log=n.Logger.getInstance(),this.onload=function(){},this.onprogress=function(){},this.onerror=function(){},r=0;r<this.audioElements.length;r++)(function(n){u.audioElements[n]=new Audio})(r);this.setVolume(i||1)}return t.prototype.audioLoaded=function(){this.isLoaded=!0},t.prototype.setVolume=function(n){this.audioElements.forEach(function(t){t.volume=n})},t.prototype.setLoop=function(n){this.audioElements.forEach(function(t){t.loop=n})},t.prototype.load=function(){var t=this,n=new XMLHttpRequest;n.open("GET",this.path,!0);n.responseType="blob";n.onprogress=this.onprogress;n.onerror=this.onerror;n.onload=function(i){if(n.status!==200){t.log.error("Failed to load audio resource ",t.path," server responded with error code",n.status);t.onerror(n.response);t.isLoaded=!1;return}t._loadedAudio=URL.createObjectURL(n.response);t.audioElements.forEach(function(n){n.src=t._loadedAudio});t.onload(i)};n.send()},t.prototype.play=function(){this.audioElements[this.index].load();this.audioElements[this.index].play();this.index=(this.index+1)%this.audioElements.length},t.prototype.stop=function(){this.audioElements.forEach(function(n){n.pause()})},t}();t.AudioTag=i;window.AudioContext&&(u=new window.AudioContext);r=function(){function t(t,i){this.context=u;this.volume=this.context.createGain();this.buffer=null;this.sound=null;this.path="";this.isLoaded=!1;this.loop=!1;this.logger=n.Logger.getInstance();this.onload=function(){};this.onprogress=function(){};this.onerror=function(){};this.path=t;this.volume.gain.value=i?i:1}return t.prototype.setVolume=function(n){this.volume.gain.value=n},t.prototype.load=function(){var n=this,t=new XMLHttpRequest;t.open("GET",this.path);t.responseType="arraybuffer";t.onprogress=this.onprogress;t.onerror=this.onerror;t.onload=function(){if(t.status!==200){n.logger.error("Failed to load audio resource ",n.path," server responded with error code",t.status);n.onerror(t.response);n.isLoaded=!1;return}n.context.decodeAudioData(t.response,function(t){n.buffer=t;n.isLoaded=!0;n.onload(n)},function(){n.logger.error("Unable to decode "+n.path+" this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file.");n.isLoaded=!1;n.onload(n)})};try{t.send()}catch(i){console.error("Error loading sound! If this is a cross origin error, you must host your sound with your html and javascript.")}},t.prototype.setLoop=function(n){this.loop=n},t.prototype.play=function(){this.isLoaded&&(this.sound=this.context.createBufferSource(),this.sound.buffer=this.buffer,this.sound.loop=this.loop,this.sound.connect(this.volume),this.volume.connect(this.context.destination),this.sound.start(0))},t.prototype.stop=function(){if(this.sound)try{this.sound.stop(0)}catch(n){this.logger.warn("The sound clip",this.path,"has already been stopped!")}},t}();t.WebAudio=r})(n.Internal||(n.Internal={}));var t=n.Internal}(ex||(ex={})),function(n){(function(n){n[n.Resolved=0]="Resolved";n[n.Rejected=1]="Rejected";n[n.Pending=2]="Pending"})(n.PromiseState||(n.PromiseState={}));var i=n.PromiseState,t=function(){function t(){this._state=2;this.successCallbacks=[];this.rejectCallback=function(){};this.logger=n.Logger.getInstance()}return t.wrap=function(n){return(new t).resolve(n)},t.prototype.then=function(n,t){if(n&&(this.successCallbacks.push(n),this.state()===0))try{n.call(this,this.value)}catch(i){this.handleError(i)}if(t&&(this.rejectCallback=t,this.state()===1))try{t.call(this,this.value)}catch(i){this.handleError(i)}return this},t.prototype.error=function(n){return n&&(this.errorCallback=n),this},t.prototype.resolve=function(n){var t=this;if(this._state===2){this.value=n;try{this._state=0;this.successCallbacks.forEach(function(n){n.call(t,t.value)})}catch(i){this.handleError(i)}}else throw new Error("Cannot resolve a promise that is not in a pending state!");return this},t.prototype.reject=function(n){if(this._state===2){this.value=n;try{this._state=1;this.rejectCallback.call(this,this.value)}catch(t){this.handleError(t)}}else throw new Error("Cannot reject a promise that is not in a pending state!");return this},t.prototype.state=function(){return this._state},t.prototype.handleError=function(n){this.errorCallback&&this.errorCallback.call(this,n)},t}();n.Promise=t}(ex||(ex={})),function(n){var r=function(){function t(t){this.path=t;this.logger=n.Logger.getInstance();this.onprogress=function(){};this.oncomplete=function(){};this.onerror=function(){}}return t.prototype._start=function(){this.logger.debug("Started loading image "+this.path)},t.prototype.isLoaded=function(){return!!this.image&&!!this.image.src},t.prototype.load=function(){var i=this,r=new n.Promise,t;return this.image=new Image,t=new XMLHttpRequest,t.open("GET",this.path,!0),t.responseType="blob",t.onloadstart=function(n){i._start(n)},t.onprogress=this.onprogress,t.onerror=this.onerror,t.onload=function(){if(t.status!==200){i.logger.error("Failed to load image resource ",i.path," server responded with error code",t.status);i.onerror(t.response);r.resolve(t.response);return}i.image.src=URL.createObjectURL(t.response);i.oncomplete();i.logger.debug("Completed loading image",i.path);r.resolve(i.image)},t.overrideMimeType&&t.overrideMimeType("text/plain; charset=x-user-defined"),t.send(),r},t}(),t,i;n.Texture=r;t=function(){function t(){for(var r,i=[],u=0;u<arguments.length-0;u++)i[u]=arguments[u+0];for(this.logger=n.Logger.getInstance(),this.onprogress=function(){},this.oncomplete=function(){},this.onerror=function(){},this.onload=function(){},this._isLoaded=!1,this._selectedFile="",this._selectedFile="",r=0;r<i.length;r++)if(t.canPlayFile(i[r])){this._selectedFile=i[r];break}this._selectedFile||(this.logger.warn("This browser does not support any of the files specified"),this._selectedFile=i[0]);this.sound=new n.Internal.FallbackAudio(this._selectedFile,1)}return t.canPlayFile=function(n){var t=new Audio,i=n.match(/.*\.([A-Za-z0-9]+)$/)[1];return t.canPlayType("audio/"+i)?!0:!1},t.prototype.setVolume=function(n){this.sound&&this.sound.setVolume(n)},t.prototype.setLoop=function(n){this.sound&&this.sound.setLoop(n)},t.prototype.play=function(){this.sound&&this.sound.play()},t.prototype.stop=function(){this.sound&&this.sound.stop()},t.prototype.isLoaded=function(){return this._isLoaded},t.prototype.load=function(){var t=this,i=new n.Promise;return this.logger.debug("Started loading sound",this._selectedFile),this.sound.onprogress=this.onprogress,this.sound.onload=function(){t.oncomplete();t._isLoaded=!0;t.logger.debug("Completed loading sound",t._selectedFile);i.resolve(t.sound)},this.sound.onerror=function(n){t.onerror(n);i.resolve(n)},this.sound.load(),i},t}();n.Sound=t;i=function(){function t(n){this.resourceList=[];this.index=0;this.resourceCount=0;this.numLoaded=0;this.progressCounts={};this.totalCounts={};this.onprogress=function(){};this.oncomplete=function(){};this.onerror=function(){};n&&this.addResources(n)}return t.prototype.addResource=function(n){var t=this.index++;this.resourceList.push(n);this.progressCounts[t]=0;this.totalCounts[t]=1;this.resourceCount++},t.prototype.addResources=function(n){var t=this;n.forEach(function(n){t.addResource(n)})},t.prototype.sumCounts=function(n){var t=0;for(var i in n)t+=n[i]|0;return t},t.prototype.isLoaded=function(){return this.numLoaded===this.resourceCount},t.prototype.load=function(){function f(n,t){n[t]&&n[t].load().then(function(){f(n,t+1)})}var i=new n.Promise,t=this,r,u;return this.resourceList.length===0?(t.oncomplete.call(t),i):(r=new Array(this.resourceList.length),u=this.resourceList.length,this.resourceList.forEach(function(n,f){n.onprogress=function(n){var e=n.total,o=n.loaded,i;r[f]={loaded:o/e*(100/u),total:100};i=r.reduce(function(n,t){return{loaded:n.loaded+t.loaded,total:100}},{loaded:0,total:100});t.onprogress.call(t,i)};n.oncomplete=n.onerror=function(){t.numLoaded++;t.numLoaded===t.resourceCount&&(t.onprogress.call(t,{loaded:100,total:100}),t.oncomplete.call(t),i.resolve())}}),f(this.resourceList,0),i)},t}();n.Loader=i}(ex||(ex={})),function(n){var r=function(){function n(n,t,r,u,f){this.image=n;this.columns=t;this.rows=r;this.sprites=[];this.internalImage=n.image;this.sprites=new Array(t*r);for(var e=0,o=0,e=0;e<r;e++)for(o=0;o<t;o++)this.sprites[o+e*t]=new i(this.image,o*u,e*f,u,f)}return n.prototype.getAnimationByIndices=function(n,i,r){var f=this,u=i.map(function(n){return f.sprites[n]});return u=u.map(function(n){return n.clone()}),new t(n,u,r)},n.prototype.getAnimationBetween=function(n,i,r,u){var f=this.sprites.slice(i,r);return f=f.map(function(n){return n.clone()}),new t(n,f,u)},n.prototype.getAnimationForAll=function(n,i){var r=this.sprites.map(function(n){return n.clone()});return new t(n,r,i)},n.prototype.getSprite=function(n){if(n>=0&&n<this.sprites.length)return this.sprites[n]},n}(),u,e,i,t,f;n.SpriteSheet=r;u=function(t){function i(i,r,u,f,e,o,s){t.call(this,i,f,e,o,s);this.image=i;this.alphabet=r;this.caseInsensitive=u;this.spriteLookup={};this.colorLookup={};this._currentColor=n.Color.Black}return __extends(i,t),i.prototype.getTextSprites=function(){for(var t,i={},n=0;n<this.alphabet.length;n++)t=this.alphabet[n],this.caseInsensitive&&(t=t.toLowerCase()),i[t]=this.sprites[n].clone();return i},i}(r);n.SpriteFont=u,function(n){var f=function(){function n(){}return n.prototype.updatePixel=function(n,t,i){var r=(n+t*i.width)*4,u=i.data,f=(u[r+0]+u[r+1]+u[r+2])/3;u[r+0]=f;u[r+1]=f;u[r+2]=f},n}(),t,i,r,u;n.Grayscale=f;t=function(){function n(){}return n.prototype.updatePixel=function(n,t,i){var r=(n+t*i.width)*4,u=i.data;u[r+0]=255-u[r+0];u[r+1]=255-u[r+1];u[r+2]=255-u[r+2]},n}();n.Invert=t;i=function(){function n(n){this.opacity=n}return n.prototype.updatePixel=function(n,t,i){var r=(n+t*i.width)*4,u=i.data;u[r+3]!==0&&(u[r+3]=Math.round(this.opacity*255))},n}();n.Opacity=i;r=function(){function n(n){this.color=n}return n.prototype.updatePixel=function(n,t,i){var r=(n+t*i.width)*4,u=i.data;u[r+3]!==0&&(u[r+0]=(u[r+0]+this.color.r)/2,u[r+1]=(u[r+1]+this.color.g)/2,u[r+2]=(u[r+2]+this.color.b)/2)},n}();n.Colorize=r;u=function(){function n(n){this.color=n}return n.prototype.updatePixel=function(n,t,i){var r=(n+t*i.width)*4,u=i.data;u[r+3]!==0&&(u[r+0]=this.color.r,u[r+1]=this.color.g,u[r+2]=this.color.b)},n}();n.Fill=u}(n.Effects||(n.Effects={}));e=n.Effects;i=function(){function t(t,i,r,u,f){this.sx=i;this.sy=r;this.swidth=u;this.sheight=f;this.scaleX=1;this.scaleY=1;this.rotation=0;this.transformPoint=new n.Point(0,0);this.flipVertical=!1;this.flipHorizontal=!1;this.width=0;this.height=0;this.effects=[];this.internalImage=new Image;this.spriteCanvas=null;this.spriteCtx=null;this.pixelData=null;this.pixelsLoaded=!1;this.dirtyEffect=!1;this.texture=t;this.spriteCanvas=document.createElement("canvas");this.spriteCanvas.width=u;this.spriteCanvas.height=f;this.spriteCtx=this.spriteCanvas.getContext("2d");this.width=u;this.height=f}return t.prototype.loadPixels=function(){this.texture.isLoaded()&&!this.pixelsLoaded&&(this.spriteCtx.drawImage(this.texture.image,this.sx,this.sy,this.swidth,this.sheight,0,0,this.swidth,this.sheight),this.internalImage.src=this.spriteCanvas.toDataURL("image/png"),this.pixelsLoaded=!0)},t.prototype.addEffect=function(n){this.effects.push(n);this.texture.isLoaded()&&this.pixelsLoaded?this.applyEffects():this.dirtyEffect=!0},t.prototype.applyEffects=function(){var n=this;this.spriteCtx.clearRect(0,0,this.swidth,this.sheight);this.spriteCtx.drawImage(this.texture.image,this.sx,this.sy,this.swidth,this.sheight,0,0,this.swidth,this.sheight);this.pixelData=this.spriteCtx.getImageData(0,0,this.swidth,this.sheight);this.effects.forEach(function(t){for(var r,i=0;i<n.sheight;i++)for(r=0;r<n.swidth;r++)t.updatePixel(r,i,n.pixelData)});this.spriteCtx.clearRect(0,0,this.swidth,this.sheight);this.spriteCtx.putImageData(this.pixelData,0,0);this.internalImage.src=this.spriteCanvas.toDataURL("image/png")},t.prototype.clearEffects=function(){this.effects.length=0;this.applyEffects()},t.prototype.transformAboutPoint=function(n){this.transformPoint=n},t.prototype.setRotation=function(n){this.rotation=n},t.prototype.getRotation=function(){return this.rotation},t.prototype.setScaleX=function(n){this.scaleX=n},t.prototype.setScaleY=function(n){this.scaleY=n},t.prototype.getScaleX=function(){return this.scaleX},t.prototype.getScaleY=function(){return this.scaleY},t.prototype.reset=function(){},t.prototype.draw=function(n,t,i){this.loadPixels();this.dirtyEffect&&(this.applyEffects(),this.dirtyEffect=!1);n.save();n.translate(t+this.transformPoint.x,i+this.transformPoint.y);n.rotate(this.rotation);this.flipHorizontal&&(n.translate(this.swidth,0),n.scale(-1,1));this.flipVertical&&(n.translate(0,this.sheight),n.scale(1,-1));this.internalImage&&n.drawImage(this.internalImage,0,0,this.swidth,this.sheight,-this.transformPoint.x,-this.transformPoint.y,this.swidth*this.scaleX,this.sheight*this.scaleY);n.restore()},t.prototype.clone=function(){var n=new t(this.texture,this.sx,this.sy,this.swidth,this.sheight);return n.scaleX=this.scaleX,n.scaleY=this.scaleY,n.rotation=this.rotation,n.flipHorizontal=this.flipHorizontal,n.flipVertical=this.flipVertical,this.effects.forEach(function(t){n.addEffect(t)}),n},t}();n.Sprite=i;t=function(){function t(n,t,i,r){this.currIndex=0;this.oldTime=Date.now();this.rotation=0;this.scaleX=1;this.scaleY=1;this.loop=!1;this.freezeFrame=-1;this.flipVertical=!1;this.flipHorizontal=!1;this.width=0;this.height=0;this.sprites=t;this.speed=i;this.engine=n;r!=null&&(this.loop=r);this.height=t[0]?t[0].height:0;this.width=t[0]?t[0].width:0}return t.prototype.addEffect=function(n){for(var t in this.sprites)this.sprites[t].addEffect(n)},t.prototype.clearEffects=function(){for(var n in this.sprites)this.sprites[n].clearEffects()},t.prototype.transformAboutPoint=function(n){for(var t in this.sprites)this.sprites[t].transformAboutPoint(n)},t.prototype.setRotation=function(n){this.rotation=n;for(var t in this.sprites)this.sprites[t].setRotation(n)},t.prototype.getRotation=function(){return this.rotation},t.prototype.setScaleX=function(n){this.scaleX=n;for(var t in this.sprites)this.sprites[t].setScaleX(n)},t.prototype.setScaleY=function(n){this.scaleY=n;for(var t in this.sprites)this.sprites[t].setScaleY(n)},t.prototype.getScaleX=function(){return this.scaleX},t.prototype.getScaleY=function(){return this.scaleY},t.prototype.reset=function(){this.currIndex=0},t.prototype.isDone=function(){return!this.loop&&this.currIndex>=this.sprites.length},t.prototype.tick=function(){var n=Date.now();n-this.oldTime>this.speed&&(this.currIndex=this.loop?(this.currIndex+1)%this.sprites.length:this.currIndex+1,this.oldTime=n)},t.prototype.draw=function(t,i,r){var u;this.tick();this.currIndex<this.sprites.length&&(u=this.sprites[this.currIndex],this.flipVertical&&(u.flipVertical=this.flipVertical),this.flipHorizontal&&(u.flipHorizontal=this.flipHorizontal),u.draw(t,i,r));this.freezeFrame!==-1&&this.currIndex>=this.sprites.length&&(u=this.sprites[n.Util.clamp(this.freezeFrame,0,this.sprites.length-1)],u.draw(t,i,r))},t.prototype.play=function(n,t){this.reset();this.engine.playAnimation(this,n,t)},t}();n.Animation=t;f=function(){function t(t){var i,r,u,f;this.lineWidth=5;this.filled=!1;this.points=[];this.transformationPoint=new n.Point(0,0);this.rotation=0;this.scaleX=1;this.scaleY=1;this.points=t;i=this.points.reduce(function(n,t){return Math.min(n,t.x)},0);r=this.points.reduce(function(n,t){return Math.max(n,t.x)},0);this.width=r-i;u=this.points.reduce(function(n,t){return Math.min(n,t.y)},0);f=this.points.reduce(function(n,t){return Math.max(n,t.y)},0);this.height=f-u}return t.prototype.addEffect=function(){},t.prototype.clearEffects=function(){},t.prototype.transformAboutPoint=function(n){this.transformationPoint=n},t.prototype.setScaleX=function(n){this.scaleX=n},t.prototype.setScaleY=function(n){this.scaleY=n},t.prototype.getScaleX=function(){return this.scaleX},t.prototype.getScaleY=function(){return this.scaleY},t.prototype.setRotation=function(n){this.rotation=n},t.prototype.getRotation=function(){return this.rotation},t.prototype.reset=function(){},t.prototype.draw=function(n,t,i){n.save();n.translate(t+this.transformationPoint.x,i+this.transformationPoint.y);n.scale(this.scaleX,this.scaleY);n.rotate(this.rotation);n.beginPath();n.lineWidth=this.lineWidth;var r=this.points[0];n.moveTo(r.x,r.y);this.points.forEach(function(t){n.lineTo(t.x,t.y)});n.lineTo(r.x,r.y);n.closePath();this.filled&&(n.fillStyle=this.fillColor.toString(),n.fill());n.strokeStyle=this.lineColor.toString();this.flipHorizontal&&(n.translate(this.width,0),n.scale(-1,1));this.flipVertical&&(n.translate(0,this.height),n.scale(1,-1));n.stroke();n.restore()},t}();n.Polygon=f}(ex||(ex={})),function(n){var t=function(){function t(t){this.focus=new n.Point(0,0);this.isShaking=!1;this.shakeMagnitudeX=0;this.shakeMagnitudeY=0;this.shakeDuration=0;this.elapsedShakeTime=0;this.isZooming=!1;this.currentZoomScale=1;this.maxZoomScale=1;this.zoomDuration=0;this.elapsedZoomTime=0;this.zoomIncrement=.01;this.engine=t}return t.prototype.setActorToFollow=function(n){this.follow=n},t.prototype.getFocus=function(t){return typeof t=="undefined"&&(t=!1),this.follow?new n.Point(0,0):this.focus},t.prototype.setFocus=function(n,t){this.follow||(this.focus.x=n,this.focus.y=t)},t.prototype.shake=function(n,t,i){this.isShaking=!0;this.shakeMagnitudeX=n;this.shakeMagnitudeY=t;this.shakeDuration=i},t.prototype.zoom=function(n,t){this.isZooming=!0;this.maxZoomScale=n;this.zoomDuration=t|0;t&&(this.zoomIncrement=Math.abs(this.maxZoomScale-this.currentZoomScale)/t*1e3);this.maxZoomScale<1?t?this.zoomIncrement=-1*this.zoomIncrement:(this.isZooming=!1,this.setCurrentZoomScale(this.maxZoomScale)):t||(this.isZooming=!1,this.setCurrentZoomScale(this.maxZoomScale))},t.prototype.getZoom=function(){return this.currentZoomScale},t.prototype.setCurrentZoomScale=function(n){this.currentZoomScale=n},t.prototype.update=function(n){var t=this.getFocus(),i=0,r=0,u=this.engine.ctx.canvas.width,f=this.engine.ctx.canvas.height,e=u*this.getZoom(),o=f*this.getZoom();this.isDoneShaking()?(this.isShaking=!1,this.elapsedShakeTime=0,this.shakeMagnitudeX=0,this.shakeMagnitudeY=0,this.shakeDuration=0):(this.elapsedShakeTime+=n,i=(Math.random()*this.shakeMagnitudeX|0)+1,r=(Math.random()*this.shakeMagnitudeY|0)+1);this.engine.ctx.translate(t.x+i,t.y+r);this.isDoneZooming()?(this.isZooming=!1,this.elapsedZoomTime=0,this.zoomDuration=0,this.setCurrentZoomScale(this.maxZoomScale)):(this.elapsedZoomTime+=n,this.setCurrentZoomScale(this.getZoom()+this.zoomIncrement*n/1e3));this.engine.ctx.scale(this.getZoom(),this.getZoom())},t.prototype.debugDraw=function(n){var t=this.getFocus();n.fillStyle="yellow";n.beginPath();this.follow&&n.arc(this.follow.x+this.follow.getWidth()/2,0,15,0,Math.PI*2);n.closePath();n.fill()},t.prototype.isDoneShaking=function(){return!this.isShaking||this.elapsedShakeTime>=this.shakeDuration},t.prototype.isDoneZooming=function(){return this.zoomDuration!=0?this.elapsedZoomTime>=this.zoomDuration:this.maxZoomScale<1?this.currentZoomScale<=this.maxZoomScale:this.currentZoomScale>=this.maxZoomScale},t}(),i,r;n.BaseCamera=t;i=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.getFocus=function(t){return typeof t=="undefined"&&(t=!1),this.follow?new n.Point(-(this.follow.getCenter().x/2)*this.getZoom()+this.engine.getWidth()*this.getZoom()/2,0):this.focus},i}(t);n.SideCamera=i;r=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.getFocus=function(t){if(typeof t=="undefined"&&(t=!1),this.follow){var i=t?this.engine.getWidth():this.engine.canvas.width,r=t?this.engine.getHeight():this.engine.canvas.height;return new n.Point(-this.follow.getCenter().x*this.getZoom()+i*this.getZoom()/2,-this.follow.getCenter().y*this.getZoom()+r*this.getZoom()/2)}return this.focus},i}(t);n.TopCamera=r}(ex||(ex={})),function(n){var i=function(){function t(t){this.path=t;this._isLoaded=!1;this.logger=n.Logger.getInstance();this.onprogress=function(){};this.oncomplete=function(){};this.onerror=function(){};this._innerElement=document.createElement("div");this._innerElement.className="excalibur-template"}return t.prototype.getTemplateString=function(){return this._isLoaded?this._htmlString:""},t.prototype._compile=function(){this._innerElement.innerHTML=this._htmlString;this._styleElements=this._innerElement.querySelectorAll("[data-style]");this._textElements=this._innerElement.querySelectorAll("[data-text]")},t.prototype._evaluateExpresion=function(n,t){var i=new Function("return "+n+";");return i.call(t)},t.prototype.apply=function(n){for(var i,t=this,r=0;r<this._styleElements.length;r++)(function(){var i={},u;t._styleElements[r].dataset.style.split(";").forEach(function(n){if(n){var t=n.split(":");i[t[0].trim()]=t[1].trim()}});for(u in i)(function(){var f=i[u];t._styleElements[r].style[u]=t._evaluateExpresion(f,n)})()})();for(i=0;i<this._textElements.length;i++)(function(){var r=t._textElements[i].dataset.text;t._textElements[i].innerText=t._evaluateExpresion(r,n)})();return this._innerElement.children.length===1&&(this._innerElement=this._innerElement.firstChild),this._innerElement},t.prototype.load=function(){var i=this,r=new n.Promise,t=new XMLHttpRequest;return t.open("GET",this.path,!0),t.responseType="text",t.onprogress=this.onprogress,t.onerror=this.onerror,t.onload=function(){if(t.status!==200){i.logger.error("Failed to load html template resource ",i.path," server responded with error code",t.status);i.onerror(t.response);i._isLoaded=!1;r.resolve("error");return}i._htmlString=t.response;i.oncomplete();i.logger.debug("Completed loading template",i.path);i._compile();i._isLoaded=!0;r.resolve(i._htmlString)},t.overrideMimeType&&t.overrideMimeType("text/plain; charset=x-user-defined"),t.send(),r},t.prototype.isLoaded=function(){return this._isLoaded},t}(),t;n.Template=i;t=function(){function n(n,t,i){this.parent=document.getElementById(n);this.template=t;this._ctx=i;this.update()}return n.prototype.listen=function(n,t,i){var r=this;i||(i=function(){r.update()});n.addEventListener&&t.forEach(function(t){n.addEventListener(t,i)})},n.prototype.update=function(){var n=this._applyTemplate(this.template,this._ctx);n instanceof String&&(this.parent.innerHTML=n);n instanceof Node&&this.parent.lastChild!==n&&this.parent.appendChild(n)},n.prototype._applyTemplate=function(n,t){if(n.isLoaded())return n.apply(t)},n}();n.Binding=t}(ex||(ex={})),function(n){var i=function(){function n(n,t,i,r){this.r=n;this.g=t;this.b=i;this.a=r;this.a=r!=null?r:1}return n.fromRGB=function(t,i,r,u){return new n(t,i,r,u)},n.fromHex=function(t){var i=null;if(i=t.match(/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i)){var u=parseInt(i[1],16),f=parseInt(i[2],16),e=parseInt(i[3],16),r=1;return i[4]&&(r=parseInt(i[4],16)/255),new n(u,f,e,r)}throw new Error("Invalid hex string: "+t);},n.prototype.toString=function(){var n=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return this.a!==undefined||this.a!==null?"rgba("+n+", "+String(this.a)+")":"rgb("+n+")"},n.prototype.clone=function(){return new n(this.r,this.g,this.b,this.a)},n.Black=n.fromHex("#000000"),n.White=n.fromHex("#FFFFFF"),n.Yellow=n.fromHex("#FFFF00"),n.Orange=n.fromHex("#FFA500"),n.Red=n.fromHex("#FF0000"),n.Vermillion=n.fromHex("#FF5B31"),n.Rose=n.fromHex("#FF007F"),n.Magenta=n.fromHex("#FF00FF"),n.Violet=n.fromHex("#7F00FF"),n.Blue=n.fromHex("#0000FF"),n.Azure=n.fromHex("#007FFF"),n.Cyan=n.fromHex("#00FFFF"),n.Viridian=n.fromHex("#59978F"),n.Green=n.fromHex("#00FF00"),n.Chartreuse=n.fromHex("#7FFF00"),n.Transparent=n.fromHex("#FFFFFF00"),n}(),t,r;n.Color=i,function(n){n[n.Num1=97]="Num1";n[n.Num2=98]="Num2";n[n.Num3=99]="Num3";n[n.Num4=100]="Num4";n[n.Num5=101]="Num5";n[n.Num6=102]="Num6";n[n.Num7=103]="Num7";n[n.Num8=104]="Num8";n[n.Num9=105]="Num9";n[n.Num0=96]="Num0";n[n.Numlock=144]="Numlock";n[n.Semicolon=186]="Semicolon";n[n.A=65]="A";n[n.B=66]="B";n[n.C=67]="C";n[n.D=68]="D";n[n.E=69]="E";n[n.F=70]="F";n[n.G=71]="G";n[n.H=72]="H";n[n.I=73]="I";n[n.J=74]="J";n[n.K=75]="K";n[n.L=76]="L";n[n.M=77]="M";n[n.N=78]="N";n[n.O=79]="O";n[n.P=80]="P";n[n.Q=81]="Q";n[n.R=82]="R";n[n.S=83]="S";n[n.T=84]="T";n[n.U=85]="U";n[n.V=86]="V";n[n.W=87]="W";n[n.X=88]="X";n[n.Y=89]="Y";n[n.Z=90]="Z";n[n.Shift=16]="Shift";n[n.Alt=18]="Alt";n[n.Up=38]="Up";n[n.Down=40]="Down";n[n.Left=37]="Left";n[n.Right=39]="Right";n[n.Space=32]="Space";n[n.Esc=27]="Esc"}(n.InputKey||(n.InputKey={}));t=n.InputKey,function(n){n[n.FullScreen=0]="FullScreen";n[n.Container=1]="Container";n[n.Fixed=2]="Fixed";n[n.Fill=3]="Fill"}(n.DisplayMode||(n.DisplayMode={}));var e=n.DisplayMode,u=function(){function n(n,t,i){this.animation=n;this.x=t;this.y=i}return n}(),f=function(){function n(t,i,r){this.id=0;this.interval=10;this.fcn=function(){};this.repeats=!1;this.elapsedTime=0;this.complete=!1;this.scene=null;this.id=n.id++;this.interval=i||this.interval;this.fcn=t||this.fcn;this.repeats=r||this.repeats}return n.prototype.update=function(n){this.elapsedTime+=n;this.elapsedTime>this.interval&&(this.fcn.call(this),this.repeats?this.elapsedTime=0:this.complete=!0)},n.prototype.cancel=function(){this.scene&&this.scene.cancelTimer(this)},n.id=0,n}();n.Timer=f;r=function(r){function f(t,u,f,e){r.call(this);this.hasStarted=!1;this.keys=[];this.keysDown=[];this.keysUp=[];this.clicks=[];this.mouseDown=[];this.mouseMove=[];this.mouseUp=[];this.touchStart=[];this.touchMove=[];this.touchEnd=[];this.touchCancel=[];this.sceneHash={};this.animations=[];this.isFullscreen=!1;this.displayMode=0;this.isDebug=!1;this.debugColor=new i(255,255,255);this.backgroundColor=new i(0,0,100);this.isSmoothingEnabled=!0;this.isLoading=!1;this.progress=0;this.total=1;console.log("Powered by Excalibur.js visit","http://excaliburjs.com","for more information.");this.camera=new n.BaseCamera(this);this.logger=n.Logger.getInstance();this.logger.debug("Building engine...");this.canvasElementId=f;this.rootScene=this.currentScene=new n.Scene;this.addScene("root",this.rootScene);f?(this.logger.debug("Using Canvas element specified: "+f),this.canvas=document.getElementById(f)):(this.logger.debug("Using generated canvas element"),this.canvas=document.createElement("canvas"));t&&u?(this.displayMode=e==undefined?2:e,this.logger.debug("Engine viewport is size "+t+" x "+u,"using DisplayMode",e),this.width=t,this.canvas.width=t,this.height=u,this.canvas.height=u):e||(this.logger.debug("Engine viewport is fullscreen"),this.displayMode=0);this.loader=new n.Loader;this.initialize()}return __extends(f,r),f.prototype.playAnimation=function(n,t,i){this.animations.push(new u(n,t,i))},f.prototype.addChild=function(n){this.currentScene.addChild(n)},f.prototype.removeChild=function(n){this.currentScene.removeChild(n)},f.prototype.addTileMap=function(n){this.currentScene.addTileMap(n)},f.prototype.removeTileMap=function(n){this.currentScene.removeTileMap(n)},f.prototype.addTimer=function(n){return this.currentScene.addTimer(n)},f.prototype.removeTimer=function(n){return this.currentScene.removeTimer(n)},f.prototype.addScene=function(n,t){this.sceneHash[n]&&this.logger.warn("Scene",n,"already exists overwriting");this.sceneHash[n]=t;t.engine=this},f.prototype.goToScene=function(t){if(this.sceneHash[t]){this.currentScene.onDeactivate.call(this.currentScene);var i=this.currentScene;this.currentScene=this.sceneHash[t];i.eventDispatcher.publish("deactivate",new n.DeactivateEvent(this.currentScene));i.eventDispatcher.update();this.currentScene.onActivate.call(this.currentScene);this.currentScene.eventDispatcher.publish("activate",new n.ActivateEvent(i));this.currentScene.eventDispatcher.update()}else this.logger.error("Scene",t,"does not exist!")},f.prototype.getWidth=function(){return this.camera?this.width/this.camera.getZoom():this.width},f.prototype.getHeight=function(){return this.camera?this.height/this.camera.getZoom():this.height},f.prototype.screenToWorldCoordinates=function(t){var i=t.x,r=t.y,u;return this.camera&&(u=this.camera.getFocus(!0),i-=u.x,r-=u.y),i=Math.floor(i/this.canvas.clientWidth*this.getWidth()),r=Math.floor(r/this.canvas.clientHeight*this.getHeight()),new n.Point(i,r)},f.prototype.worldToScreenCoordinates=function(t){var i=t.x,r=t.y,u;return this.camera&&(u=this.camera.getFocus(),i+=u.x*(this.getWidth()/this.canvas.clientWidth),r+=u.y*(this.getHeight()/this.canvas.clientHeight)),i=Math.floor(i/this.getWidth()*this.canvas.clientWidth),r=Math.floor(r/this.getHeight()*this.canvas.clientHeight),new n.Point(i,r)},f.prototype.setHeightByDisplayMode=function(n){if(this.displayMode===1&&(this.width=this.canvas.width=n.clientWidth,this.height=this.canvas.height=n.clientHeight),this.displayMode===0&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.width=this.canvas.width=n.innerWidth,this.height=this.canvas.height=n.innerHeight),this.displayMode===3){var u=n.innerWidth/this.canvas.width,f=n.innerHeight/this.canvas.height,t=Math.min(u,f),i=Math.floor(this.canvas.width*t),r=Math.floor(this.canvas.height*t);this.width=i;this.height=r;this.canvas.style.width=i.toString()+"px";this.canvas.style.height=r.toString()+"px"}},f.prototype.initialize=function(){var t=this,i;(this.displayMode===0||this.displayMode===1||this.displayMode===3)&&(i=this.displayMode===1?this.canvas.parentElement||document.body:window,this.setHeightByDisplayMode(i),window.addEventListener("resize",function(){t.logger.debug("View port resized");t.setHeightByDisplayMode(i);t.logger.info("parent.clientHeight "+i.clientHeight);t.setAntialiasing(t.isSmoothingEnabled)}));window.addEventListener("blur",function(){t.keys.length=0});window.addEventListener("keyup",function(i){var u=t.keys.indexOf(i.keyCode),r;t.keys.splice(u,1);t.keysUp.push(i.keyCode);r=new n.KeyUp(i.keyCode);t.eventDispatcher.publish(n.EventType[1],r);t.currentScene.publish(n.EventType[1],r)});window.addEventListener("keydown",function(i){if(t.keys.indexOf(i.keyCode)===-1){t.keys.push(i.keyCode);t.keysDown.push(i.keyCode);var r=new n.KeyDown(i.keyCode);t.eventDispatcher.publish(n.EventType[0],r);t.currentScene.publish(n.EventType[0],r)}});window.addEventListener("blur",function(){t.eventDispatcher.publish(n.EventType[14],new n.BlurEvent);t.eventDispatcher.update()});window.addEventListener("focus",function(){t.eventDispatcher.publish(n.EventType[15],new n.FocusEvent);t.eventDispatcher.update()});this.canvas.addEventListener("mousedown",function(i){var f=i.pageX-n.Util.getPosition(t.canvas).x,e=i.pageY-n.Util.getPosition(t.canvas).y,u=t.screenToWorldCoordinates(new n.Point(f,e)),r=new n.MouseDown(u.x,u.y,i);t.mouseDown.push(r);t.clicks.push(r);t.eventDispatcher.publish(n.EventType[3],r)});this.canvas.addEventListener("mousemove",function(i){var f=i.pageX-n.Util.getPosition(t.canvas).x,e=i.pageY-n.Util.getPosition(t.canvas).y,r=t.screenToWorldCoordinates(new n.Point(f,e)),u=new n.MouseMove(r.x,r.y,i);t.mouseMove.push(u);t.eventDispatcher.publish(n.EventType[4],u)});this.canvas.addEventListener("mouseup",function(i){var f=i.pageX-n.Util.getPosition(t.canvas).x,e=i.pageY-n.Util.getPosition(t.canvas).y,r=t.screenToWorldCoordinates(new n.Point(f,e)),u=new n.MouseUp(r.x,r.y,i);t.mouseUp.push(u);t.eventDispatcher.publish(n.EventType[5],u)});this.canvas.addEventListener("touchstart",function(i){var r=i;r.preventDefault();var e=r.changedTouches[0].pageX-n.Util.getPosition(t.canvas).x,o=r.changedTouches[0].pageY-n.Util.getPosition(t.canvas).y,u=t.screenToWorldCoordinates(new n.Point(e,o)),f=new n.TouchStart(u.x,u.y);t.touchStart.push(f);t.eventDispatcher.publish(n.EventType[6],f)});this.canvas.addEventListener("touchmove",function(i){var r=i;r.preventDefault();var e=r.changedTouches[0].pageX-n.Util.getPosition(t.canvas).x,o=r.changedTouches[0].pageY-n.Util.getPosition(t.canvas).y,u=t.screenToWorldCoordinates(new n.Point(e,o)),f=new n.TouchMove(u.x,u.y);t.touchMove.push(f);t.eventDispatcher.publish(n.EventType[7],f)});this.canvas.addEventListener("touchend",function(i){var r=i;r.preventDefault();var e=r.changedTouches[0].pageX-n.Util.getPosition(t.canvas).x,o=r.changedTouches[0].pageY-n.Util.getPosition(t.canvas).y,u=t.screenToWorldCoordinates(new n.Point(e,o)),f=new n.TouchEnd(u.x,u.y);t.touchEnd.push(f);t.eventDispatcher.publish(n.EventType[8],f)});this.canvas.addEventListener("touchcancel",function(i){var r=i;r.preventDefault();var e=r.changedTouches[0].pageX-n.Util.getPosition(t.canvas).x,o=r.changedTouches[0].pageY-n.Util.getPosition(t.canvas).y,u=t.screenToWorldCoordinates(new n.Point(e,o)),f=new n.TouchCancel(u.x,u.y);t.touchCancel.push(f);t.eventDispatcher.publish(n.EventType[9],f)});navigator.maxTouchPoints&&(this.canvas.addEventListener("pointerdown",function(i){if(i.pointerType==="touch"){i.preventDefault();var f=i.pageX-n.Util.getPosition(t.canvas).x,e=i.pageY-n.Util.getPosition(t.canvas).y,r=t.screenToWorldCoordinates(new n.Point(f,e)),u=new n.TouchStart(r.x,r.y);t.touchStart.push(u);t.eventDispatcher.publish(n.EventType[6],u)}}),this.canvas.addEventListener("pointermove",function(i){if(i.pointerType==="touch"){i.preventDefault();var f=i.pageX-n.Util.getPosition(t.canvas).x,e=i.pageY-n.Util.getPosition(t.canvas).y,r=t.screenToWorldCoordinates(new n.Point(f,e)),u=new n.TouchMove(r.x,r.y);t.touchMove.push(u);t.eventDispatcher.publish(n.EventType[7],u)}}),this.canvas.addEventListener("pointerup",function(i){if(i.pointerType==="touch"){i.preventDefault();var f=i.pageX-n.Util.getPosition(t.canvas).x,e=i.pageY-n.Util.getPosition(t.canvas).y,r=t.screenToWorldCoordinates(new n.Point(f,e)),u=new n.TouchEnd(r.x,r.y);t.touchEnd.push(u);t.eventDispatcher.publish(n.EventType[8],u)}}));this.ctx=this.canvas.getContext("2d");this.canvasElementId||document.body.appendChild(this.canvas)},f.prototype.setAntialiasing=function(n){this.isSmoothingEnabled=n;this.ctx.imageSmoothingEnabled=n;this.ctx.webkitImageSmoothingEnabled=n;this.ctx.mozImageSmoothingEnabled=n;this.ctx.msImageSmoothingEnabled=n},f.prototype.getAntialiasing=function(){return this.ctx.imageSmoothingEnabled||this.ctx.webkitImageSmoothingEnabled||this.ctx.mozImageSmoothingEnabled||this.ctx.msImageSmoothingEnabled},f.prototype.isKeyDown=function(n){return this.keysDown.indexOf(n)>-1},f.prototype.isKeyPressed=function(n){return this.keys.indexOf(n)>-1},f.prototype.isKeyUp=function(n){return this.keysUp.indexOf(n)>-1},f.prototype.update=function(i){if(!this.isLoading){this.eventDispatcher.update();this.currentScene.update(this,i);var r=this.eventDispatcher;this.keys.forEach(function(i){r.publish(t[i],new n.KeyEvent(i))});this.animations=this.animations.filter(function(n){return!n.animation.isDone()});this.keysDown.length=0;this.keysUp.length=0;this.clicks.length=0;this.mouseDown.length=0;this.mouseMove.length=0;this.mouseUp.length=0;this.touchStart.length=0;this.touchMove.length=0;this.touchEnd.length=0;this.touchCancel.length=0;this.eventDispatcher.publish(n.EventType[16],new n.UpdateEvent(i))}},f.prototype.draw=function(n){var i=this.ctx,r,u;if(this.isLoading){i.fillStyle="black";i.fillRect(0,0,this.width,this.height);this.drawLoadingBar(i,this.progress,this.total);return}if(i.clearRect(0,0,this.width,this.height),i.fillStyle=this.backgroundColor.toString(),i.fillRect(0,0,this.width,this.height),this.isDebug){for(this.ctx.font="Consolas",this.ctx.fillStyle=this.debugColor.toString(),r=0;r<this.keys.length;r++)this.ctx.fillText(this.keys[r].toString()+" : "+(t[this.keys[r]]?t[this.keys[r]]:"Not Mapped"),100,10*r+10);u=1e3/n;this.ctx.fillText("FPS:"+u.toFixed(2).toString(),10,10)}this.ctx.save();this.camera&&this.camera.update(n);this.currentScene.draw(this.ctx,n);this.animations.forEach(function(n){n.animation.draw(i,n.x,n.y)});this.isDebug&&(this.ctx.strokeStyle="yellow",this.currentScene.debugDraw(this.ctx),this.camera.debugDraw(this.ctx));this.ctx.restore()},f.prototype.start=function(n){var r,i,t;return n&&(r=this.load(n)),this.hasStarted||(this.hasStarted=!0,this.logger.debug("Starting game..."),i=Date.now(),t=this,function u(){if(t.hasStarted){window.requestAnimationFrame(u);var r=Date.now(),n=Math.floor(r-i)||1;n>200&&(n=1);t.update(n);t.draw(n);i=r}}(),this.logger.debug("Game started")),r},f.prototype.stop=function(){this.hasStarted&&(this.hasStarted=!1,this.logger.debug("Game stopped"))},f.prototype.drawLoadingBar=function(n,t,i){var o,h,c;if(this.loadingDraw){this.loadingDraw(n,t,i);return}var f=this.canvas.height/2,r=this.canvas.width/3,e=r,s=new Image;s.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAEsCAYAAAA7Ldc6AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjenhJ3MAAA6Y0lEQVR4Xu3dUagkWZ3ncUEEQYSiRXBdmi2KdRUZxgJZhmV9qOdmkWJYlmYYhkKWcWcfpEDQFx9K2O4Fm6UaVhoahi4GF2wWh1pnYawHoXzxpVu6Gimatqni0kpTiGLhgy++3Pn9Mk6kkXlPZp4TGSfiROT3A39aq25EnMi6GfH/ZcSJ/BAAAAAAAAAAAAAAYAw/+9nPLqluqO6rroc/BgAAAIDhhNBxV3Ue6mn4KwAAAAA4nkLGddUdh40QOrp1J/wYAAAAAPSjYHHV4UIVCx3duhoWAQAAAIB0DhOq26qzEC4O1VlYFAAAAAAOU4i4rLrpMBFCxYV66623zt99993z999///ydd97p/t3tsBoAAAAAiFNwaEPHgxAkotWGjt/85jer+vWvf739M9x+BQAAAOAihYX2sbndJ1hdKF/hODs7W4WNNni09fjx4+7PPgirBgAAAICGgsLB0PHzn/98Z+joln+us9zNsAkAAAAAp0zhYN9jc1flMOErGk+ePImGje3yz22t43LYHAAAAIBTo0Bw8LG5b7/99vl7772XHDq6xe1XAAAAwIlTEDj42Nw2dHzwwQfRYJFaXk9nvTfCEAAAAAAsmZr/rMfmxsJEbjm8bG3jUhgOAAAAgKVRw9/rsblDla+gdLZzNwwLAAAAwFKo0T/6sblDFbdfAQAAAAvlBl81yGNzh6hf/epX3W17gju3XwEAAABzpqZ+8MfmDlW+raszjjthyAAAAADmRM180cfmDlWe0N4Z0/UwfAAAAAC1UwM/2mNzhyhPaO+M7WnYDQAAAAC1UwPvuR3dhn5dQz82d6ji9isAAABghtS8R8NHjaGjLU9w3xrv1bA7AAAAAGqlxn0jfPhqx1hPsDqmPMbOuM/C7gAAAAColRr3C+GjhrkdKeXvF+mM/XbYJQAAAAA1UtM+2/DB7VcAAADAjKhhn234cPn7RjrjfxB2CwAAAEBt1LDPOny4/KWHnX24GXYNAAAAQE3UrM8+fPhLD7v7oLocdg8AAABALdSozz58uB49etQNH9x+BQAAANRGjfpG+PAtTHMMHy5/E3tnX26EXQQAAABQAzfpnYZ9FT5q/46PXeXQ1N0X1aWwmwAAAACmpgZ9MeHD9d5773XDx92wmwAAAACmpgZ9UeHDxe1XAAAAQIXcnHca9UWEj/fff78bPp6quP0KAAAAmJoa88WFD9e7777bDSB3wu4CAAAAmIoa80WGD5cfG9zZt+thlwEAAABMQU35YsPH9u1XYZcBAAAATEFN+WLDh+udd97pBpDbYbcBAAAAjE0N+aLDh/elu3+qq2HXAQAAAIxJzfiiw4fr7OysGz7Owq4DAAAAGJOa8cWHDxe3XwEAAAATUyN+EuHjyZMn3fDhuhxeAgAAAABjUBN+EuHD9fjx4274eBBeAgAAAABjUBN+MuHD5f3r7O/N8DIAAAAAKE0N+EmFD26/AgAAACai5vukwofr0aNH3fBxP7wUAAAAAEpS831y4cP19ttvdwPIjfByAAAAACjFjXenCT+Z8PHBBx90w4frUnhJAAAAAJSgpvskw4frvffe64aPu+ElAQAAAFCCmu6TDR8ubr8CAAAARuKGu9N8n1z4eP/997vh42l4WQAAAAAMTQ33SYcP17vvvtsNIHfCSwMAAABgSGq2Tz58uN56661uALkeXh4AAAAAQ1GjTfhQPX78uBs+uP0KAAAAGJoabcKH6uzsrBs+XLfDSwQAAABgCGqyCR+qSPh4oOK7PwAAAIChqMEmfKgIHwAAAEBharAJHyrCBwAAAFCYGmzCh4rwAQAAABSmBpvwoSJ8AAAAAIWpwSZ8qAgfAAAAQGFqsAkfKsIHAAAAUJgabMKHivABAAAAFKYGm/ChInwAAAAAhanBvt1puAkffyrCBwAAADAkNdh3Og034eNPRfgAAAAAhqQGm/ChInwAAAAAhanBJnyoCB8AAABAYWqwCR8qwgcAAABQmBpswoeK8AEAAAAUpgab8KEifAAAAACFqcEmfKgIHwAAAEBharAJHyrCBwAAAFCYGmzCh4rwAQAAABSmBpvwoSJ8AAAAAIWpwSZ8qAgfAAAAQGFqsAkfKsIHAAAAUJgabMKHivABAAAAFKYGm/ChInwAAAAAhanBJnyoCB8AAABAYWqwCR8qwgcAAABQmBpswoeK8AEAAAAUpgab8KEifAAAAACFqcEmfKgIHwAAAEBharAJHyrCBwAAAFCYGmzCh4rwAQAAABSmBpvwoSJ8AAAAAIWpwSZ8qB49etQNHi7CBwAAADAkNdiED9W7777bDR4uwgcAAAAwJDXYhA8V4QMAAAAoTA024UNF+AAAAAAKU4NN+FARPgAAAIDC1GATPlSEDwAAAKAwNdiEDxXhAwAAAChMDTbhQ0X4AAAAAApTg034UBE+AAAAgMLUYBM+VIQPAAAAoDA12IQPFeEDAAAAKEwNNuFDRfgAAAAAClODTfhQET4AAACAwtRgEz5UhA8AAACgMDXYhA8V4QMAAAAoTA024UNF+AAAAAAKU4NN+FARPgAAAIDC1GATPlSEDwAAAKAwNdiEDxXhAwAAAChMDTbhQ0X4AAAAAApTg034UBE+AAAAgMLUYBM+VIQPAAAAoDA12IQPFeEDAAAAKEwNNuFDRfgAMHfn5+ffUCULixWh1b/QbCXJm2GxIrT+e81mktwLiwEASlCDTfhQET4ALIGa5yoCiFb9pWYLWV4Iiw9O6yaAAEAN1GBvhI+HDx8SPpoaLXz4RNec7xbhG2G3AEzE78Pm7ZgmLDY4rfrNZgvZroRVDErrJYAAwNTUYG+EDzfhseZ86TX1lQ+f6Jrz3SIQQICJ+X3YvB3ThMUGpdVeadbey1fDagal9RJAAGBKarAJH6oabrvyia453y0CAQSYmN+HzdsxTVhsUFptn9uvWq+E1QxK6yWAAMBU1GATPlQ1hA/zia453y0CAQSYmN+HzdsxTVhsUFrtMQGkSPPv9TarT0IAAYChqMEmfKhqCR/mE11zvlsEAggwMb8Pm7djmrDYoLRaroAAAAgfbdUUPswnuuZ8twgEEGBifh82b8c0YbFBabXMAQGAU6cGm/Chqi18mE90zfluEQggwMT8PmzejmnCYoPTqh81W8jGU7AAYO7UYBM+VDWGD/OJrjnfLQIBBJiY34fN2zFNWGxwWvVzzRayFDuGaN0EEAAYgxpswoeq1vBhPtE157tFIIAAE/P7sHk7pgmLFaHVv9JsJQnfhA4Ac6cGm/Chqjl8mE90zfluEQggwMT8PmzejmnCYsVoEynjcVD5RFikCK2fAAIAJanBJnyoag8f5hNdc75bBAIIMDG/D5u3Y5qwWFHajCelv6Dqfju654g4eHwp/FhR2g4BBABKUYNN+FDNIXyYT3TN+S5NWAwAonSYqC6A1EC7SgABgBLUYBM+VHMJH+YTXXO+SxMWA4AoHSYIIBHaVQIIAAxNDTbhQzWn8GE+0TXnuzRhMQCI0mGCABKhXSWAAMCQ1GATPlRzCx/mE11zvksTFgOAKB0mCCAR2lUCCAAMRQ024UM1x/BhPtE157s0YTEAiNJhggASoV0lgADAENRgEz5Ucw0f5hNdc75LExYDgCgdJgggEdpVAggAHEsNNuFDNefwYT7RNee7NGExAIjSYYIAEqFdJYAAwDHUYBM+VHMPH+YTXXO+SxMWA4AoHSYIIBHaVQIIAPSlBpvwoVpC+DCf6JrzXZqwGABE6TBBAInQrhJAAKAPNdiED9VSwof5RNec79KExQAgSocJAkiEdpUAAgC51GATPlRLCh/mE11zvksTFgOAKB0mCCAR2lUCCADkUINN+FBFwsd91WzDh/lE15zv0oTFACBKhwkCSIR2lQACAKnUYBM+VJHwcSe8RLPmE11zvksTFgOAKB0mCCAR2lUCCIDy/unvPnRZdS2hbiXUHdX9Tt0ImynKTXa36SZ8LCt8mE90zfkuTVgMAKJ0mCCARGhXCSAALlJT7zCw3ejvqvOJ61YYdjFusrtNN+FjeeHDfKJrzndpwmIAEKXDBAEkQruac6wlgACnwk39VpNfc90Nwy7CTXa36SZ8LDN8mE90zfkuTVgMAKJ0mCCARGhXc461BBDgVKipHzSA/OhrHz7/6bc+drAevvTM+S9e/uTeevzdT62qs/77YdiDc5PdbboJH8sNH+YTXXO+SxMWAwajX6svqZ5XuXH176PrkWoX/137c17Gy34hrK56Gqv396th7O1+vKna5Xeq2exvGGOysNjiaVf975dqkACi9XxB5d+XF7zOULvM5ncM86LfpSsqH/NeV8WOde0x7hWVf+5KWPQ0qKlfB5AHL146/+33Lu+sP/7ws+fn//z5UesPP/jMamxthWEPyk12t+kmfCw7fFh40ycLiwG96dfITVHbfA/N66zmBKZxfEL1nMon1n0how+ftL3e58LmqqDxEEAitKs5v++9A4iWdcD178W+EJ/K66judwzzoN8b/y72Oc6f1hVANfXrAOKrDrEQMHW14wt1OQx9EG6yu0034WP54cP8Rm/e72nCYrOnXfEnMm7gcj0fVjEpjcONbe74Jzuoa9t+vf0p7BBNUSo3/P4k9xNhGKPw9sJ2/WnfWPy6uvEfdV9jwjiShcWK0Opzjm9F3x9ef7OZJNlj0TL+nSv5/vK6He5r+B2b9XlLQ8p6j8iXwqKD07oH/73Uz/lDpqx/oy0EkNrKt2y1Y1RdD0M/mpvsbtNN+DiN8GF+ozfv9zRhsUXQ7vhkmutRWHxSGoeb+RwOK6NfFdA2/QnYmI14jPf9G2FIxWgbDln+tLhPsB2Ktz1pSNb2CSARXn+zmSTJY9HPlg4e22r4HZv1eUtDWmwA0c/0Oa9uO7kA4idgnbs83yIWAKYu3xrWjlE1yJOw3GR3m27Cx+mED/MbvXm/pwmLLYZ2KWv/g+LN7D7avj9dyvXVsPgotD03431e22LC0AanVfe9zaAkj2eST6q1XQJIhNffbCZJSqM39XvMVxgnmSei7Wbtd1isGhrSIgOI/t4fwAzh5ALI+vG6nucRCwBT1y9f/fRqfKGOnojuJrvbdBM+Tit8mN/ozfs9TVhsMbRLfZp5fwI42W0I2nbWv5mMdjDXtnz7Ue7VmVGEIQ5Gq2yveNTKv6ejN4jaJgEkwutvNpPkUKPneUVTXmlrTXI1RNuc9XlLQ1pcANHfDXksJIDUVr9//cpqfKGehqH34ia723QTPk4vfJjf6M37PU1YbFG0W7knA3slLD4qbde3W+RwgzDKrVfajsPcmLeCZAnDHIRW1+d3ZgqjhxBtjwAS4fU3m0myr9HLPQaMYdSrwtrerM9bGtKiAoj+fOgPYgggNZYf79uOU3U1DD+Lm+xu0034OM3wYX6jN+/3NGGxxdGu9XlC0diNXZ+J56PceqXt1NgUbQhDPZpW5Vuu5mS0EGraFgEkwutvNpNkrEZvSKN9KKNtzfq8pSEtJoDoz4aY87GNAFJjvfHtj6/GGOpmGH4SNdiXVPc7DTfh4091cuHD/EZv3u9pwmKLo13r01SOepDU9nJvbRplfNpOzU3RWhju0bSquQUQezMMvzhtiwAS4fU3m0kSa/Rym9YpvBCGW5S2M+vzloa0iACi/9/nFuYUo55bJ6dmfhYBpO8XEqrBdvh40Gm4CR9/qpMMH+Y3evN+TxMWWyTtXp+5C6M8H1/byT3Qj/Kpt7Yxi/BhYchH06rmGEBslNtkvJ1mc2nCYkVo9TnHt2oDiP5/9VcYO4rPCdE2Zn3e0pCWEkCG/m6jFgGkxtr+QkLVpbALO6nBJnyEInxs8hu9eb+nCYstknbPtzjlzmEY5bG82k7Wv5MUv/VK2xgyfDgw+XG9PjG7wY+ecPXnDmL+e1/29/aT/73CKo6mVR0bQDzmdl89mdjru/BQA/9Z+Dvvq38+9/a7mDFCKQEkwutvNpNkPRb97z6fMvt3zB+oOLj4d+jCv7v/LPxd+14a4verVfT2VK1/1uctDWn2AUT/u8StVy0CSK31469/ZDXOUDfCLkSpwSZ8hCJ8XOQ3evN+TxMWWyztohvCXEWbfa0/d0zFD97axlDhw+s56iqSlncj5ZPh3jASfvxoWlWfAOIA4WawdwDQsu0XHOaG5K7i9+lrGwSQCK+/2UyS1Vj035wPRRwg/Nof8zvmY80Q39vjMRd7UqDWPevzloY06wCi/+bMR/Tvk4/PF/ZBf9Z+yOLjWvcDJQJIrfXwpWdW4wx1N+zCBWqwCR+hCB9xfqM37/c0YbFF027mnoB9IC5ysvV6VTkNp8dS9FNurT/35BnjdQz+mmmdPplFf6fDjxxNq0oNIP5384l30P30+lTHBMCqfj/CYkVo9TnHtxoDSMqxaBU8VhsZiNbnqy5Z54aIYvNBtO5Zn7c0pLkHkJTx+xiVfazRMg7Bo8wlqkanoV/d5hRr/GuprcfxuqK3YanJvtttugkfhI9teqPfUyULiy2adjPn051WkQOm1pt7oqrtasw2N1RFG2DTNi4EkfBXR9OqDgUQ3xc9xn3wfecFFD25a/0EkAivv9lMEv9synvN76eSVxqOvc2myK1YWu+sz1sa0twDyL4Pxfx3o3//0Kx1G/pY019bpdyGpUb7Vrfx/vWvfx1t0JdchI/9dKC4tzpkJAqLLZ52tU9zN2hj7fU1q01WuoHqE8xaXm6KLyzzv+NqzOGPjqZV7QogPvGOuo/aXm4jY78Lixeh9RNAIrz+ZjNJHGIPXfkc6xHbvhrS931f5DX1epvVpwmLVUNDmm0AUe0Lxv77YoF4sTrNfLThr622bsOKPg1LzbZvwXraNt+PHj2KNulLLcLHYeGAkSwsdhK0u1mvjQx6svX6mtUmcYNQ+taa3Nej5bFN9omYtu3gNNi/jdYVCyBuKCY58Wq7ff5dSjY0BJAIr7/ZzCDGDrrHhJDBf9e0zqzXMixWDQ1pzgFk122Br4dVIlenmY82/LVV5GlYl8OubFDTvb4K8tZbb53MVRDCRxodNO41x440YbGToN31FYjck+4gJwqtJ/dWp1pvvfInucVvuRqT9qcbQCa/3cDbX40kT7FH8nrdzSbShMWK0Opzjm9zCSCjX0k0bbfP75kN/rp6nc2q04TFqqEhzTWA7Loq5+M8Vz766jbzsYa/xvrptz62HrPqdtiVDWq8T+4qCOEjnQ4a91aHj/kq+t0GXn+zmWRHP5ZX68ideF66cep761XxqzJT0D61AaTo/fc5NI7cSenFfme0bgJIhNffbOYok4SPlrbfd07I0LenZr2WYbFqaEhzDSAxizzOj6rTyEeb/Rrrl69+ej1m1VPVrsnoG3NBnjx5Em3cl1CEjzw6cNxbHULmq/iXq2kbuV+2dFSToOVzTk7FD/5af+7J0jyuRU5E1H45gIxy/30qjSf7ClVYdHBaNQEkwutvNtNb8Ucop9A4+uzHoA8+0PqyxhAWq4aGtKQAMsqX8S5ap5GPNvu11tZk9Jthdy5QI37WNuXvvPNOtHmfexE+8ungca85hszWGAEk99YDN9+9PhnXcrkTz0vfetX36gcnpZHpNc/9dyr1hCICSITX32ymF18RreVqW59bUwd98IHWl/VahsWqoSEtJYAUfc+cjE4TH230a61fvPzJ9bhVZ2F3LlAzfr3bnP/qV7+KNvFzLcJHPz6ANMeR2SoeQMzbaTaXrNe4tFzOv0fxg7+2kbvfdlrPcK+EXvfc27CKNDVaLwEkwutvNtNLsQa0D42nz3FhsA8ltK6s1zIsVg0NaSkBhFuvjqXG/VKniY82+rXWH3/42fMffe3D67Grdn4zupry+22D/vbbby9mQjrhoz8dQO41x5HZGiuA5M7LsKyDs34+5zYafwJZ/OCvbeTuczWf1J4ave659+cXee94vc3q04TFitDqc45vtQaQ6j5l1ph8PMw12AcTWlfWaxkWq4aGtIQAUsUtgbOnpv1a28B7Ynes0a+5Mq6CXFatJ6S/99570YZ+TkX4OI4OIn0PPrUYJYCYtrXr+x92SX4soX42N+AUn4OgbfR58tWkk2RPmV773N9PAsimWgNIVVc/WhpX7hW3ox/Q0dK6sl7LsFg1NKQlBBC+bHAIatpnHUAiV0FuhV27QA36xoT0Od+KRfg4ng4ifQ8+tRgtgJi2V+Q2F/1czglplE9EtZ1dz3vfZbAGA/n0+ud+Kl3Ft/eHxYrQ6nOObzUGkOqufrQ0tj6P5R3kqq3Wk/VahsWqoSHNPYC8GRbHsdSwzzqAuLaugux8IpapUX/QNu1z/W4QwscwdCDpc/CpydgBJHdS9sEDtX4mZ1LnWLde9bnFgqsfEwv/DqmKNLdaLwEkwutvNpOl6veUxpd7i+Yg80C0nqzXMixWDQ1p7gGkqqcAzpqa9dkHkMhVkOj3gpia9auq9a1Yc3sqFuFjODqQ9Dn41GTUAGLaZu6tSXubCP19zpWGUQ782s7zzeaScfWjAvp3yAnHBJBNNQaQqudTaXy5V4QHOV5rPVmvZVisGhrS3AMIt18NRc367AOI6/F3P7Xah05dDbt4gZr2m90mfi5fUEj4GJYOJPea48lsjR5ATNvNCQ07J2brz3Pu2x/tdgxtK7ex4MlXFdC/Q877mQCyqbYAMtr7vS+NMfeDikH2yetpVpcmLFYNDWnOAYQPm4akRn0RAcT1k29+dLUfoe6HXYxS836328zXPh+E8DE8HUxyDz61mSqA5D4LPzpO/XnqLQyj3HrV0rZyb63gE7EK6N8h5/1MANlUWwCZ5NiWQ2PM/d6iQZpXrSfrtQyLVUNDmnMASX64ChKoUV9MAPnt9y6v9qNT+76c8JJqYz7IBx98EG3+py7CRxk6mNxrjilpwmIQvRw5jz11gNi4CqL/n3MSGu2eW21rkqYC6fSa+8qZbwX075CvVvl9nBOIjQCyqbYAUqzpHFIYa7Kw2FG0mlmftzSkOQeQ6oPxrKhJX0wAcT148dJqX0J5QvrlsKsXqJHfmA/y85//vKpJ6R6L56i04wtF+BiIDiZZB5+wGAK9JDmv3/q56frfOVdQijZG27S93DkuPA++AL2uQ4SMfQggm2oLILP4Ph2NM3e/jr6Sq3VkbTMsVg0Nac4BZBbBeDbUoN9oG/Y3vv3xaFM/p4pMSD90K9bGt6TXEkI8Bo+lOzYV4WNAOphkHXzCYgj0kuQ+inJ18tV/U+eQjHrrlWl7uSdHnn7Vk1670iFjHwLIpqoCSFisehpq7uO6j25gtY5Zv5Ya0pwDyKjno8VTg36rbdb9ONtYUz+3evLas6v96dTO7wYxNfY3uo3+w4cPo6FgrCJ8jEMHk3vNMSVNWAwdellyTiZuMnMmno/+uENtM7ehYP7HAX6NVL5l7wWV33NjhYx9CCCbagogs/meBY119GZa65j1eUtDmm0ACYthKG7O20Z9KQHE9fClZ1b71KlrYZej3OB3G37Pu4iFg9JF+BiPjif3msNKmrAYtuilebN5hZKkNp+TNCHaLr8TR9LL4u9R8ROCHOZqCBsxBJBNNQWQomMZksZKAMmkIRFA0FBjvsgA4luxtp6KtfcLCs2NfrfxHzuEED7GpeMJB58B6KXJuaqRapIrC2HbqZiA3qHXw7dT5V5BmgoBZBMBpAeNNbeZPnoSs9Yx6/OWhjTXADKb38vZUFO+yADi+v3rV7bngzwIu72TG/5uAHAIGWNOCOFjfD6gNMeVNGExROjl8e01Q5nsSSNh+6k4IYleB1/tyH108dQIIJsIID1orASQTBoSAQQNNeWLDSCuX7766dW+depgU+/GvxsEHAxKhhDCxzR8QGmOK2nCYojQy+PbboZoQie7/1vb9j7kOOkTkvbfV77mFjxaBJBNBJAeNFYCSCYNiQCChhryRQcQV2Q+yN5J6eYA0A0EpUII4WM6PqA0x5U0YTHsoJco9xG2MZNN6ta2c28lO8lvQNd+O6gNecVrCgSQTQSQHjRWAkgmDYkAgoab8bYxX2oAcfkRw+1+hroRXoKdHAS6wWDoLyskfEzLB5TmuJImLIY99DIdMwdgsluvTNvPDSCTjncK2meHj5yHDpTg961/z9zI+PYv/7t5XDnvZwLIJgJIDxorASSThkQAQUON+DqA+IsI/W3if/jBZ6JN/JwrMindlRJCbnUDgkPI2dlZNFDkFOFjej6gNMeVNGEx7KGXKfc2pq5Jv3xM2yeA7KH99eN0x3iqlbfh96Yf27wRMsJQovT3Oe9nAsgmAkgPGisBJJOGRABBQ0343a2mfF0OJL59yd+r4QY+1tjPqbwPP/76R7b3MyWEbHxPiOuYJ2QRPurgA0pzXEkTFsMeepn8fQ99TXpLk7ZPANlB++pgOXT48JWUNmT49r2jGg0tn/N+JoBsIoD0oLGO3kxrHbM+b2lIBBA01IDf32rId5avILSBJNbgz6EiT8ZypYSQq6qnncCwChG5t2QRPurhA0pzXEkTFsMOeolyvxk9ptjJ5hBvuxlCslMKIEPcduV1uPko8m+s9ea8nwkgmwggPWisBJBMGhIBBA0131dV11W+FeuOKjmQeF6FnzI1t6sjR4SQS6oHneCwuiXr8ePH0bCxXYSPuviA0hxX0oTFsINeoiGaVD9VaZJbsbTd3AByEick7ecxE8797+mG40pYXTHaRs77mQCyiQDSg8aaO+eNAEIAwSFqyB1Mbqhuqx6ozvfVgxcvzerKSN8QYgoNt7dCxPnDhw/Pnzx5Eg0eLsJHfXxAaY4racJiiNDLk3tS2WeSW7G0XQLIFu1j36tavl3r+bCaUWh7Oe9nAsgmAkgPHmsz5GRHB3GtY9bnLQ2JAII8as4vqXylxFdJzlTnsfIcCz9Naw5XRXaEkKRQoPBwTXXWCROrevTo0SpsED7q5wNKc1xJExbDFr00uY17imInnV20zdwJ9KcQQLLeI4E/FR79Kpa2mTNWAsgmAkgPGmvW9+CExY6i1cz6vKUhEUBwHDXqvkLiqyPRMOLG3ldFan+i1o6nY/k2tEthV3dSiPAtWRuP6nW9/fbb5++//z7ho3I+oDTHlTRhMXToZXHTXuLL6Ca5FavZdLqw2CJp9/pc/XglLD46bTvn/UwA2UQA6SGMN9XvwmJH0Xpmfd7SkAggGI6a9WsqXxk5j1XtQWRHCPFtZ1fDLu6lQBG9GuLbsggf9fIBpTmupAmLoUMvi59ilMonnpywMvqtWNpm7pOeJn10cEnat5x/W5v0BO3tN8NIQgDZRADJpHFOcsum1pM1JyssVg0NiQCC4alh921aN1XRqyK1BxGPb2vMT1Wp80J8NcTfGbLxpKytInxUxAeU5riSJiyGQC9JzjefvxmW8Xc65Bj1VixtL+t3Qka/VWws2rfcMFZ8ovk+2n7OeAkgmwggmTTO3EeOD/KBitZTze9YHxoSAQRluXFXXZi87luzap4j8vi7n9oYbyh/V8rBW7JMIeOyg0YndBA+KuUDSnNcSRMWg+jlyP1eiC+ERb1sztOyRr0VS9vK/dR/kY/i1X7lfro72a1XrTCOVASQTTUFkEdhsappnLnHiq+GRY+i9cw9gOQ+VY8Agn7UuPv2rAtXRDxZvdanZvnb4COT070P18JuHaTA4e8NuU/4qJcPKM1xJU1YDKKXI+fxkxuf/On/5za3o92KpW3lfjq3yJOS9iv3dXguLDoJbf9KM4xkBJBNNQWQWRxrNczcuW/rD2GOofXkvjerukqr8WT9LggBBMdR8+4rIheCiL9LpMarIR6Tvwl+e7wqz3VJuhpiDiLhf6IyPqA0x5U0YbGTp5ci59YDXyW5cAVDf5b76eEoJ1Fvp9lclsXNA9E+Zb03ZNLXQNuf5H78bVovASTC6282k2yQZr0Uj68ZZrqw6NG0qrkHkNxbOwkgGIaad3/hoedWnLflqw21Xg3xLVmRqyHJc0NQLx9QmuNKmrDYSdPL4E+ac04g0e+C0J/nrme0W7GazWUZ9fsuxqB9yvl0d/JbZjSG3KaMALKptgAyyO1KpWh8ubcRDfb6al25v+vV3CaqseReqTQCCIaj5v2y6sI3rtd6NcQT53dcDfEcl+TbslAXH1Ca40qasNhJ08uQM39j7wFbfz/JJM5DtJ2s3wtZ3Ikp7FeqyfffY2iGkqzImLVeAkiE199sJtnrYdEqaXy5t18NFqi0rtnNz2ppLLkPITECCNL8q+f+x+XwPw9S8+4vNty4GuK5If6CwFgQmLp2XA1xOUwRRGbGB5TmuJImLHay9BLkfvJ28KlI+pmcQGPFbyfQNnKDkVV9y0gO7cusvpBR288drxFANtUWQKzKWxs1rj63aQ52fNC6cre/egJhDTSWnLmDLQIIDlP4uKU6D/9Nmiehxt2P7r1wNeSXr346GgKmLl+hiTyuty2CyIz4gNIcV9KExU6Sdj/3nueky/76udyTafFbsbT+PrcJVPMp47G0L1XMp0il7fcJjASQTTUGkCpvbdS4cpvoQW9R1Pr6BO7Jw5zH0AwlGwEE+ylwXA/ho62nqpvhrw9S4+7vD3ETvy43+rEQUEP5Ks2O27JcDiLXw66hUj6gNMeVNGGxk6Nd94mj2KNz9bO5E9KL34qlbeRembFFXAXRfswtgOTeDmMEkE01BpDqHserMfX5cGLwORhaZ+5E7snDnMaQewW9RQDBbgoaV0Pg6AaQth6okp4Epab9qmrjSVlu8mv9zhCXH9m7J4h4XzzpPvm2NIzHB5TmuJImLHZytOtFn9uun3fAqebJKKb197lXeREnKO3HbAKItt3n38kIIJtqDCBW1VUQjafPfgz+BZ1aZ+44Jp1To+33Oca3CCCIU7i4FELGKnD86//0P1fV/v9O3VYdvC1Lzbpvydr4AsOffPOjVYcQ14Eg4vJVET+KOPkRvijLB5TmuJImLHZStNu5zWivE52Wy72NpuitWF63qs8Js+qn96TQPuTebjfJJ9Xarv+N+lz9MALIploDiN+DVcwF0TieW40oT6nfs9wPhWzwIJRK2+579cMIIIhTqLjbCRnnX/zK98//w3/7f+efe/7VbvhoK+dqiL9vw437qjz5u9bJ6d3yE7N869iOyeptOYz4ljOujEzIB5TmuJImLHYytMu5Tbh/tvdJTsvm3vZU9FYsrb/vSXP2t2KF/cgxenOjbfZpwloEkE21BhCb/IlYGkPfDySKNM9ab58wNMnjeLVd37bW57VrEUBwkcJEO+l8VX/216+d/8f//v/X5TDyb67/r24AaetWWMVeoUl3w76quYQQl6/YeCK9r9509yFSvk3LYctXR/jSwhH5gNIcV9KExU6Gdjl3suVRn/5r+dyrLVby5NS36fAysw4hzW5kGbW50fb6/K50EUA21RxAbNJbsbT9Pk9vKvaaat0+NuU66gOivrTNPvPpuggg2KQQsTHp/N/9l1c2wke3Pv9Xf98NH23dV6XckuXG3I36quYUQtryVZGHLz2zesRwd1/2lK+Q3FZ5/sg1FcGkAB9QmuNKmrDYSdDu5n7CNsijHrWe3E+1S9+K1fcqiMc12S0Px9LYs94b4uZmlFtltB3fInbMJ6pGANlUewCx58LqRqXt5j4ko1WscTatv09jP+rVJG2v72vXRQDBnyg4bEw691UO33YVCx9t/fv/+n/Pn/3yd7ZDyJnqYHOtBnz2IaQthxF/n8iB+SLRCi8HBuIDSnNcSRMWWzztap9L5oN84q/19LnqUOxWLK3b4+k7z8D7MemVEG9flf36eBlVrjGeTjZE+DACyKY5BBD/uxdt6rdpe30b6OLNqrbR5/HTNsrVJG2n7/i2EUDQUGC4MOn8L/72H6OhY7scUnylpF02lIPMjbD6ndSAXwghtU9MTylPXv/Fy59cBZID80YIIAPzAaU5rqQJiy2edjXrdZFBG0+tr7Zvyz3mdh83TZPcPqLtts1w9olTy/S5x9yK7avWPVT4MALIpjkEkNZYDfQxn94X/+BB2/AHRX0VfQ21/r5XjmMIIGgoLFyYdB4LG/vKc0W66wh18DtD1IRvhJA5PB0rt3yF5Mlrz65CyRvf/vh6X1X3w8uAgfiA0hxX0oTFFk27mfuplRvCwW+90Tqz/m2k9K1Yx0x4Nt9DPtYtSg5w3as2fQJIn3vMW4M3N16nal/48N/lhBMCyKY5BRDz+7HI+0nrdWN/zHhHmw+lbfWZm9Iq8T71cePQmHI/RCCA4PCk85zyLVmRx/XeCZvaSY34hRASa+SXUL460tlXAsjAfEBpjiuL0vsgqWX7fMJc5L5srddjyVX6qVjHTqb0a+sGtURg84l/O3i0ev1OaLljPgEepAnTelKbQb+uOe9nAsimmgKIf4dTjkP+ucGaaK3L7yH/++UeA7sGmQuXSts79mEMg30wovX4qmns+NPlv896jwgB5NQpHCRPOk8t37oVeUpWSgjZeDpWzd+YfkwRQMryAaU5rizKMQEkt8Eu3bT0uepQ8mTVZ27MLm7ujw5vXkdY175x9fp30nLHNje9G0Qt522nBqBV06f/5ryfi/zuar0EkAivv9lMEv9szuu4+j1T9WqktZzf18cGD/PyUzxl6tjzmMft/e81di3n1z51DH5fE0CQTqEge9J5ank9PUPIxveE+JG3sSZ+zkUAKcsHlOa4sih9m83ck4IVPdlq/f5EMrcpcDNS7FYnrXvIeQjmdfn30K+/w4RP0BfG7z8Lf+ef8c/m/O72PnF62WYVR/E+Oky4UbnQTOjP2n3z3/vnDn2Kum11v73+O8prso/Wm/U+CosVodVP/nq0vP5mM0lWY9F/+1xx9Hb8b+DfpwvzMPRn3d81f8Bx7FXNrqme0tXnavEufj3aY9G+18+36vrqSc6xcHWFWv/Neo8IAeRUKQz0nnSeWjsmp6eEED+u9rytuT4Za1cRQMryAaU5rixK9kFSy/iEkmuU+5y1HTcKuUrfijV0CCmt94lTyw7Z3JSw/u4Z/e+c93ORZkLrJYBEeP3NZpKsxqL/DnnFsbSik7oP0faPnaNWmoPN6oMV/ZcAgjQKAkdPOk+t3BCipvySyl/kd+7y92wsaVI6AaQsH1Ca48qiZB0k9fP+RCv3E+dHYfFRaHt9/p2KnbRM659TCDnqxKnlcxuGsbwShrii/5/ze1KkmdB6CSARXn+zmSTrseh/+5P42k0aPloax5BXc4bk4+T6aor+NwEEhykADDbpPLV6hJCrnSZ99eSoWDM/xyKAlOUDSnNcWZSsg6R+vqp5FjHanj8JzVX0VizT+h1CcsPbFI4+cWodxzxtp4QL++Q/a/4qSZFmQuslgER4/c1mkmyMRf+/z1XQsVQRPkxj8YdJNX4osnG+0P8ngGA/Nf6DTzpPrUgI2fuIXjXnG5PS/UV/sYZ+bkUAKcsHlOa4sijJB0n9bJ9PFzc+dR6LttvnU/gxvhjPJ/3af4+OPnFqHd7PWj5h9esdmyeT8+9QpJnQegkgEV5/s5kkF8aiP6sthLjRryZ8tDSm2q7MXniN9GcEEOymhr/YpPOU2jExfe+XFapBv9s26/5CP3+fRqypn1M5SLX7pDo4JwZ5fEBpjiuLknSQ1M/1+bTMP1/0qsIu3q6qz9WGUa7WaDuelFnjp482yIlT66khhOwMwPq7nPdzkWZC6yWARHj9zWaSRMeiP68lhPg9UPyLBvvy2FRTX5n1sTD6GunPCSCIU6NffNJ5SkVCiAPR1TDMC9Sgez7I07Zh9zeLx5r6OZW/jLDdH9WtsKsYiA8ozXFlUZIOkvq5PrfUrCf8TkHb73PFpvitWC1tx7eK1fY75fEM+rQyrW+KCa9uaPb+/unvc157Asim6gOI6e+mbq5H+5LBY2icU16ZdUDbeczR3xFAEKcmf7RJ54fKwWfrywrPVJfCUC9Qk36907CvvlE81tjPpQggZfmA0hxXFuXgQVI/k/tt51bFwdfjaIaTpfitWF3anp8qNvXvlrdf8sTtMDhWI+h9ORiiws+lKvL7rPUSQCK8/mYzSfaORX/v5nrsEOzHQxd97HgJGrOvGo11ZdbbORjQ/DOrn05HADkFau5Hn3R+qPyN6d0xqfbOhVCjvr4Va+5PxSKAlOUDSnNcWZRDJ+++j7as4pYDjaPPhHQb5VasLm3Tn9Ye+pLAITkQuDEbrVHSttxMlAoifn8m/7uFn09FANk0mwDS0s/5WJD6ZZV9+H07y+DRpfE7sPn3stRxKOt10s8RQLBJjf1kk84P1Z//zT90A4hrZzOuRv2yan0rlpv4WHM/hyKAAMugk5evGPgkPXSz7tsdHDomDYjavvcv94vJYtpmptp77FEX/a44iAwVhNvfv+ommA9B+9Ueh4YIIz72+Gr6JPMCsRBq6CeddJ5SkSdj7ZsPcqvTuM92QjoBBFgenbDdMLkRcNPkpv2eat/kbjdW/hmXl/FJf/QrOqk8tjBGNzr79q3dL/+cf57QgaPod8jvLd925FC+73fPDXj3PeVlTur3z/ur8vuufa1cu3RfKx+7CB04nhr5KiadHyoHome//J1uADk0H2T9BYUPXrwUbfBrLwIIAAAAFkdNfDWTzg9VZD7I7bAbF6hh35iQPserIAQQAAAALIoa+OomnR+qz//V33cDiGvfrVj32wZ+jldBHr70DAEEAAAAy6DGvdpJ54dq6/tBHoRdukBN+7VOAz+7qyD+LpPO+K+F3QIAAADmRU179ZPO91XkVqybYdcuUOM+26sgBBAAAADMnpr1C5PO3dDHGv2aK/It6dEJ6WrcZzsXhAACAACA2VOjvjHp/OqN/xNt8GstX6m58pcvd8OHywHkctjFC9S8r5+INafvBSGAAAAAYNbUpG9MOveE7liTX2v5Ss3Wo3hdvpqzM3yYmvcbbSPvb0ePNfs1FgEEAAAAs6UmfWPS+b/9z/872uTXWv42dN8u1t0H1R3Vzu8Caal5v6Rafzv6k9eejTb8tRUBBAAAALOkJn3Wk84/9/yr28HDtXPieYwa+DttM//Gtz8ebfhrKwIIAAAAZkeN+mwnne+Z77Hzuz92UQN/tdPMn//xh5+NNv01FQEEAAAAs6NmfZaTzvfM9zh4y9UuauLXk9F/+eqno01/TfWjr324G0D2znMBAAAAJqdmfZaTznfN9wi71Zua+NttQz+H27DasbrCLgAAAAB1UsM+y0nn/kb27rhD3Qi7dRQ18rO6Das71rALAAAAQH3UsM9u0rnHt/Xlgq5e8z32UTO/vg2r9qdhteN0heEDAAAAdVHDPrtJ5x5f5Jaro+Z77KJmfn0b1oMXL0Ub/1qqHacrDB8AAACoi5r2WU0693yP7nhDHT3fYxc189fbpr72LyVsx+kKwwcAAADqocZ9VpPOS8732Kfb2P/hB5+JNv81VHecYegAAABAHdS4z2bS+Y75HmeqQed77KKG/n7b2Nf8ON52jK4wdAAAAGB6btxVs5h0vmO+x33V4PM9dlFDf6tt7B++9Ey0+Z+6/ISudoyuMHQAAABgWm7cVbOYdL5jvsftsCujUUO/ngfibxuPBYCp67ffu9wNIPfD0AEAAIBpqYGvftK5r8ZE5nv4ik3x+R4xaugvd5r7aACYugggAAAAqI4a+Judhr7KSed/8bf/OOl8j13U1D9tG/zfv34lGgKmLAIIAAAAqqIG/lqnoa9y0vkXv/L9yed77OKmvm3wa/xCQgIIAAAAqqEG/rKq6knnf/bXr20HD9fo8z12UVO/8YWEbvgP1ePvfur8Fy9/8mB5Xsmh+sk3P9oNGIeKAAIAAIBpqImvetJ5bfM9dlFTv34S1gyKAAIAAIBpqJG/02nsq5p0Xut8jxg19de2mvxay3NVqrlyBAAAgBOiRr7aSec1z/eIUVPfDSBu8j0n5FDdUfnKyaHyY369/r0VhgIAAADUR418tZPOd8z3uBWGDgAAAGBO1MxXOel8z3yP62HoAAAAAOZEzXyVk853zPfwOKub7wEAAAAgkRr66iadewyR+R7+RvYq53sAAAAASKCGvrpJ5x5Dd0yhmO8BAAAAzJma+qomnXu+h8fQHZOK+R4AAADA3Kmpr2rSueecMN8DAAAAWCA19RuTzl3+jo1YMBijmO8BAAAALJga+41J5y4HAM+9GPsqCPM9AAAAgIVTg++5Hw4h61uw2nr2y98Z5SlYe+Z78O3dAAAAwBKp2fetWH4K1plqIwz4y/9KXQ3ZM9/jchgaAAAAgKVS4+8gcku1cUXEIWHoLyTcMd/DV2OY7wEAAACcEoUAPxnrfggFqxryW9E/9/yr3dDR1s2weQAAAACnSKHAV0PWIeHYEOJbua785cvd0OFivgcAAAAwV//0dx+6prquutWpmyr/efbcCoWDGyEkHBVCvIwntrfrCcV8DwAAAGBOHCpCwLivOk+op6o7quRvFVdIuKraCCE5E9P//G/+gfkeAAAAwJwpQDh4OEjEQkZqnaluhFXupbDgELIOEJ6YHgsb28V8DwAAAGDGFBguqW6HAHGhfvz1j5z/9FsfO3/40jPnv3j5k6t68OKl1Z/Ffj6Ug8jBeRgKDr4dax0k/OWBsdDhYr4HAAAAMHMKCVdVD0JoWNdPvvnR88ff/dT5H37wmfPzf/783nry2rOrQPKjr314Yx2hbodN7aQAcbsTKKLzQZjvAQAAAMycwoHDh+dvrAODr3b89nuXo0HjUP3xh59dXR3pri+U55LsnJuhEOHvCll/YaGvcnTDx675HmFxAAAAALVTILgQPhweYsEit3zVxFdQuutW+SrLvhByrRswvviV76/Cx475HklzTAAAAABUQEFgI3z41qm+Vz32lW/LarcRau9VCwULP8VqFTJ8FcST0tv/H8rzPa6GHwcAAABQO4UATzhfz/lw+Pj961eiAWKIioSQnU+rUrjwt6Vvh462PN+DR+wCAAAAc6IAsPG0qxJXPrbrjW9/vBtAXDsnjitkrK+CdIr5HgAAAMDcuPHvBoGh5nwcKk9O9+T2zrbvhyFdoLCxMRdExXwPAAAAYI7U+K+/ZNCTxGNhoVT5Sku77VA7v7tDocNPxGK+BwAAADBXavg3rn6McevVdm19ceHO26oUPK6rmO8BAAAAzJUa/ptt8z/21Y+2IldBCBkAAADAEqnZXz/5yt9wHgsIY9TWXBDmdwAAAABL1Gn6V18UGAsHY9TDl57pBpDbYXgAAAAAlkKN/rW26fcViFgwGKuevPZsN4DsfBoWAAAAgJlSo3+jbfo9ETwWDMYqX31px+IKQwQAAACwFGr0b7UN/1jf/bGv2rG4whABAAAALIUafQIIAAAAgHGo0SeAAAAAABiHGv11APFTqGKhYMxqx+IKQwQAAACwFGr010/BmnoS+taXEZ6FIQIAAABYCjX6V9um/0df+3A0GIxVv3z1090AwmN4AQAAgCVSs/+0bfx///qVaDgYo9749se7AeRWGB4AAACAJVGzf7dt/KeaB/LHH352dQWmHYfqahgeAAAAgCVRs7/+MkKHAIeBWEgoWVu3XzH/AwAAAFgyNf3r27DGfhyvA8+Pv/6RbgDh9isAAABgydz0twHAV0H+8IPPRMNCiXLgabetchC6FIYFAAAAYInc9KvOQggY7ZG8nvTebjMUVz8AAACAU6Dm/3o3DDx48VI0NAxVvsqyNfH8QRgKAAAAgFOgEHCnEwiKhRCHj59886Pd8OFbr3jyFQAAAHBqFAQedILBKoQM+WQs33a1deXDdSNsHgAAAMApURjwfJCNEOKrFb/93uVooMiprQnnbRE+AAAAgFOmUOAQcr8TElblqyG535buqyf+no+tR+22RfgAAAAA0FBAWD+et1u+IuKrGb4qErs9yyHFocOBJXK7lctP3GLOBwAAAIBNDgqqC1dDepYnmzvU8F0fAAAAAHZTaLimuquKBYtDRfAAAAAAkM8hQnVD5Uf2bkxW75QDh6+aOHRcC4sCAAAAAAAAAAAAAAAAAAAAAAAg1Yc+9C+CyYFQsnpjxgAAAABJRU5ErkJggg==";o=r*3/8;h=this.getAntialiasing();this.setAntialiasing(!0);n.drawImage(s,0,0,800,300,e,f-o-20,r,o);n.strokeStyle="white";n.lineWidth=2;n.strokeRect(e,f,r,20);c=r*(t/i);n.fillStyle="white";var u=5,r=c-u*2,l=20-u*2;n.fillRect(e+u,f+u,r>0?r:0,l);this.setAntialiasing(h)},f.prototype.setLoadingDrawFunction=function(n){this.loadingDraw=n},f.prototype.load=function(t){var i=this,r=new n.Promise;return this.isLoading=!0,t.load(),t.onprogress=function(n){i.progress=n.loaded;i.total=n.total;i.logger.debug("Loading "+(100*i.progress/i.total).toFixed(0))},t.oncomplete=function(){setTimeout(function(){i.isLoading=!1;r.resolve()},500)},r},f}(n.Util.Class);n.Engine=r}(ex||(ex={})),function(n){(function(t){(function(t){var b=function(){function t(t,i,r,u){this._started=!1;this._stopped=!1;this.actor=t;this.end=new n.Vector(i,r);this.speed=u}return t.prototype.update=function(){this._started||(this._started=!0,this.start=new n.Vector(this.actor.x,this.actor.y),this.distance=this.start.distance(this.end),this.dir=this.end.minus(this.start).normalize());var t=this.dir.scale(this.speed);this.actor.dx=t.x;this.actor.dy=t.y;this.isComplete(this.actor)&&(this.actor.x=this.end.x,this.actor.y=this.end.y,this.actor.dy=0,this.actor.dx=0)},t.prototype.isComplete=function(t){return this._stopped||new n.Vector(t.x,t.y).distance(this.start)>=this.distance},t.prototype.stop=function(){this.actor.dy=0;this.actor.dx=0;this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}(),r,u,f,k,e,o,s,h,c,l,a,v,y,p,w,i;t.MoveTo=b;r=function(){function t(t,i,r,u){if(this._started=!1,this._stopped=!1,this.actor=t,this.end=new n.Vector(i,r),u<=0){n.Logger.getInstance().error("Attempted to moveBy time less than or equal to zero : "+u);throw new Error("Cannot move in time <= 0");}this.time=u}return t.prototype.update=function(){this._started||(this._started=!0,this.start=new n.Vector(this.actor.x,this.actor.y),this.distance=this.start.distance(this.end),this.dir=this.end.minus(this.start).normalize(),this.speed=this.distance/(this.time/1e3));var t=this.dir.scale(this.speed);this.actor.dx=t.x;this.actor.dy=t.y;this.isComplete(this.actor)&&(this.actor.x=this.end.x,this.actor.y=this.end.y,this.actor.dy=0,this.actor.dx=0)},t.prototype.isComplete=function(t){return this._stopped||new n.Vector(t.x,t.y).distance(this.start)>=this.distance},t.prototype.stop=function(){this.actor.dy=0;this.actor.dx=0;this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();t.MoveBy=r;u=function(){function t(t,i,r){this._started=!1;this._stopped=!1;this.actor=t;this.actorToFollow=i;this.current=new n.Vector(this.actor.x,this.actor.y);this.end=new n.Vector(i.x,i.y);this.maximumDistance=r!=undefined?r:this.current.distance(this.end);this.speed=0}return t.prototype.update=function(){var n,t;this._started||(this._started=!0,this.distanceBetween=this.current.distance(this.end),this.dir=this.end.minus(this.current).normalize());n=Math.sqrt(Math.pow(this.actorToFollow.dx,2)+Math.pow(this.actorToFollow.dy,2));n!=0&&(this.speed=n);this.current.x=this.actor.x;this.current.y=this.actor.y;this.end.x=this.actorToFollow.x;this.end.y=this.actorToFollow.y;this.distanceBetween=this.current.distance(this.end);this.dir=this.end.minus(this.current).normalize();this.distanceBetween>=this.maximumDistance?(t=this.dir.scale(this.speed),this.actor.dx=t.x,this.actor.dy=t.y):(this.actor.dx=0,this.actor.dy=0);this.isComplete(this.actor)&&(this.actor.x=this.end.x,this.actor.y=this.end.y,this.actor.dy=0,this.actor.dx=0)},t.prototype.stop=function(){this.actor.dy=0;this.actor.dx=0;this._stopped=!0},t.prototype.isComplete=function(){return this._stopped},t.prototype.reset=function(){this._started=!1},t}();t.Follow=u;f=function(){function t(t,i,r){this._started=!1;this._stopped=!1;this._speedWasSpecified=!1;this.actor=t;this.actorToMeet=i;this.current=new n.Vector(this.actor.x,this.actor.y);this.end=new n.Vector(i.x,i.y);this.speed=r||0;r!=undefined&&(this._speedWasSpecified=!0)}return t.prototype.update=function(){var n,t;this._started||(this._started=!0,this.distanceBetween=this.current.distance(this.end),this.dir=this.end.minus(this.current).normalize());n=Math.sqrt(Math.pow(this.actorToMeet.dx,2)+Math.pow(this.actorToMeet.dy,2));n==0||this._speedWasSpecified||(this.speed=n);this.current.x=this.actor.x;this.current.y=this.actor.y;this.end.x=this.actorToMeet.x;this.end.y=this.actorToMeet.y;this.distanceBetween=this.current.distance(this.end);this.dir=this.end.minus(this.current).normalize();t=this.dir.scale(this.speed);this.actor.dx=t.x;this.actor.dy=t.y;this.isComplete(this.actor)&&(this.actor.x=this.end.x,this.actor.y=this.end.y,this.actor.dy=0,this.actor.dx=0)},t.prototype.isComplete=function(){return this._stopped||this.distanceBetween<=1},t.prototype.stop=function(){this.actor.dy=0;this.actor.dx=0;this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();t.Meet=f,function(n){n[n.Clockwise=0]="Clockwise";n[n.CounterClockwise=1]="CounterClockwise";n[n.ShortestPath=2]="ShortestPath"}(t.RotationStrategy||(t.RotationStrategy={}));k=t.RotationStrategy;e=function(){function t(t,i,r,u){typeof u=="undefined"&&(u=2);this._started=!1;this._stopped=!1;this._rotationStrategy=2;this._traveled=0;this.actor=t;this.end=n.Util.canonicalizeAngle(i);this.speed=Math.abs(r);this._rotationStrategy=u}return t.prototype.update=function(t){if(!this._started)if(this._started=!0,this.actor.rotation=n.Util.canonicalizeAngle(this.actor.rotation),this.distance=this.end-this.actor.rotation,this._rotationStrategy===2){var i=this.distance;this.speed=i>0?1*Math.abs(this.speed):-1*Math.abs(this.speed)}else this._rotationStrategy===0?this.speed=1*Math.abs(this.speed):this._rotationStrategy===1&&(this.speed=-1*Math.abs(this.speed));this.actor.rx=this.speed;this._traveled+=Math.abs(this.speed*t/1e3);this.isComplete(this.actor)&&(this.actor.rotation=this.end,this.actor.rx=0)},t.prototype.isComplete=function(){return this._stopped||this._traveled>Math.abs(this.distance)},t.prototype.stop=function(){this.actor.rx=0;this._stopped=!0},t.prototype.reset=function(){this._started=!1;this._traveled=0},t}();t.RotateTo=e;o=function(){function n(n,t,i){this._started=!1;this._stopped=!1;this.actor=n;this.end=t;this.time=i;this.speed=(this.end-this.actor.rotation)/i*1e3}return n.prototype.update=function(){this._started||(this._started=!0,this.start=this.actor.rotation,this.distance=Math.abs(this.end-this.start));this.actor.rx=this.speed;this.isComplete(this.actor)&&(this.actor.rotation=this.end,this.actor.rx=0)},n.prototype.isComplete=function(){return this._stopped||Math.abs(this.actor.rotation-this.start)>=this.distance},n.prototype.stop=function(){this.actor.rx=0;this._stopped=!0},n.prototype.reset=function(){this._started=!1},n}();t.RotateBy=o;s=function(){function n(n,t,i,r,u){this._started=!1;this._stopped=!1;this.actor=n;this.endX=t;this.endY=i;this.speedX=r;this.speedY=u}return n.prototype.update=function(){var n,t;this._started||(this._started=!0,this.startX=this.actor.scaleX,this.startY=this.actor.scaleY,this.distanceX=Math.abs(this.endX-this.startX),this.distanceY=Math.abs(this.endY-this.startY));Math.abs(this.actor.scaleX-this.startX)>=this.distanceX?this.actor.sx=0:(n=this.endY<this.startY?-1:1,this.actor.sx=this.speedX*n);Math.abs(this.actor.scaleY-this.startY)>=this.distanceY?this.actor.sy=0:(t=this.endY<this.startY?-1:1,this.actor.sy=this.speedY*t);this.isComplete(this.actor)&&(this.actor.scaleX=this.endX,this.actor.scaleY=this.endY,this.actor.sx=0,this.actor.sy=0)},n.prototype.isComplete=function(){return this._stopped||Math.abs(this.actor.scaleX-this.startX)>=this.distanceX&&Math.abs(this.actor.scaleY-this.startY)>=this.distanceY},n.prototype.stop=function(){this.actor.sx=0;this.actor.sy=0;this._stopped=!0},n.prototype.reset=function(){this._started=!1},n}();t.ScaleTo=s;h=function(){function n(n,t,i,r){this._started=!1;this._stopped=!1;this.actor=n;this.endX=t;this.endY=i;this.time=r;this.speedX=(this.endX-this.actor.scaleX)/r*1e3;this.speedY=(this.endY-this.actor.scaleY)/r*1e3}return n.prototype.update=function(){this._started||(this._started=!0,this.startX=this.actor.scaleX,this.startY=this.actor.scaleY,this.distanceX=Math.abs(this.endX-this.startX),this.distanceY=Math.abs(this.endY-this.startY));var n=this.endX<this.startX?-1:1,t=this.endY<this.startY?-1:1;this.actor.sx=this.speedX*n;this.actor.sy=this.speedY*t;this.isComplete(this.actor)&&(this.actor.scaleX=this.endX,this.actor.scaleY=this.endY,this.actor.sx=0,this.actor.sy=0)},n.prototype.isComplete=function(){return this._stopped||Math.abs(this.actor.scaleX-this.startX)>=this.distanceX&&Math.abs(this.actor.scaleY-this.startY)>=this.distanceY},n.prototype.stop=function(){this.actor.sx=0;this.actor.sy=0;this._stopped=!0},n.prototype.reset=function(){this._started=!1},n}();t.ScaleBy=h;c=function(){function n(n,t){this.elapsedTime=0;this._started=!1;this._stopped=!1;this.actor=n;this.delay=t}return n.prototype.update=function(n){this._started||(this._started=!0);this.x=this.actor.x;this.y=this.actor.y;this.elapsedTime+=n},n.prototype.isComplete=function(){return this._stopped||this.elapsedTime>=this.delay},n.prototype.stop=function(){this._stopped=!0},n.prototype.reset=function(){this.elapsedTime=0;this._started=!1},n}();t.Delay=c;l=function(){function n(n,t,i,r){this._started=!1;this.nextBlink=0;this.elapsedTime=0;this.isBlinking=!1;this._stopped=!1;this.actor=n;this.frequency=t;this.duration=i;this.numBlinks=Math.floor(t*i/1e3);this.blinkTime=r||200}return n.prototype.update=function(n){this._started||(this._started=!0,this.nextBlink+=this.duration/this.numBlinks/2);this.x=this.actor.x;this.y=this.actor.y;this.elapsedTime+=n;this.elapsedTime+this.blinkTime/2>this.nextBlink&&this.nextBlink>this.elapsedTime-this.blinkTime/2?(this.isBlinking=!0,this.actor.invisible=!0):(this.isBlinking&&(this.isBlinking=!1,this.nextBlink+=this.duration/this.numBlinks),this.actor.invisible=!1);this.isComplete(this.actor)&&(this.actor.invisible=!1)},n.prototype.isComplete=function(){return this._stopped||this.elapsedTime>=this.duration},n.prototype.stop=function(){this.actor.invisible=!1;this._stopped=!0},n.prototype.reset=function(){this._started=!1;this.nextBlink=0;this.elapsedTime=0;this.isBlinking=!1},n}();t.Blink=l;a=function(){function t(n,t,i){this.multiplyer=1;this._started=!1;this._stopped=!1;this.actor=n;this.endOpacity=t;this.speed=i;t<n.opacity&&(this.multiplyer=-1)}return t.prototype.update=function(t){this._started||(this._started=!0);this.speed>0&&(this.actor.opacity+=this.multiplyer*Math.abs(this.actor.opacity-this.endOpacity)*t/this.speed);this.speed-=t;n.Logger.getInstance().debug("actor opacity: "+this.actor.opacity);this.isComplete(this.actor)&&(this.actor.opacity=this.endOpacity)},t.prototype.isComplete=function(){return this._stopped||Math.abs(this.actor.opacity-this.endOpacity)<.05},t.prototype.stop=function(){this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();t.Fade=a;v=function(){function n(n){this._started=!1;this._stopped=!1;this.actor=n}return n.prototype.update=function(){this.actor.actionQueue.clearActions();this.actor.kill();this._stopped=!0},n.prototype.isComplete=function(){return this._stopped},n.prototype.stop=function(){},n.prototype.reset=function(){},n}();t.Die=v;y=function(){function n(n,t){this._method=null;this._actor=null;this._hasBeenCalled=!1;this._actor=n;this._method=t}return n.prototype.update=function(){this._method.call(this._actor);this._hasBeenCalled=!0},n.prototype.isComplete=function(){return this._hasBeenCalled},n.prototype.reset=function(){this._hasBeenCalled=!1},n.prototype.stop=function(){this._hasBeenCalled=!0},n}();t.CallMethod=y;p=function(){function n(n,t,r){var u=this;this._stopped=!1;this.actor=n;this.actionQueue=new i(n);this.repeat=t;this.originalRepeat=t;r.forEach(function(n){n.reset();u.actionQueue.add(n)})}return n.prototype.update=function(n){this.x=this.actor.x;this.y=this.actor.y;this.actionQueue.hasNext()||(this.actionQueue.reset(),this.repeat--);this.actionQueue.update(n)},n.prototype.isComplete=function(){return this._stopped||this.repeat<=0},n.prototype.stop=function(){this._stopped=!0},n.prototype.reset=function(){this.repeat=this.originalRepeat},n}();t.Repeat=p;w=function(){function n(n,t){var r=this;this._stopped=!1;this.actor=n;this.actionQueue=new i(n);t.forEach(function(n){n.reset();r.actionQueue.add(n)})}return n.prototype.update=function(n){(this.x=this.actor.x,this.y=this.actor.y,this._stopped)||(this.actionQueue.hasNext()||this.actionQueue.reset(),this.actionQueue.update(n))},n.prototype.isComplete=function(){return this._stopped},n.prototype.stop=function(){this._stopped=!0;this.actionQueue.clearActions()},n.prototype.reset=function(){},n}();t.RepeatForever=w;i=function(){function n(n){this._actions=[];this._completedActions=[];this.actor=n}return n.prototype.add=function(n){this._actions.push(n)},n.prototype.remove=function(n){var t=this._actions.indexOf(n);this._actions.splice(t,1)},n.prototype.clearActions=function(){this._actions.length&&(this._actions.length=0,this._completedActions.length=0,this._currentAction.stop())},n.prototype.getActions=function(){return this._actions.concat(this._completedActions)},n.prototype.hasNext=function(){return this._actions.length>0},n.prototype.reset=function(){this._actions=this.getActions();this._actions.forEach(function(n){n.reset()});this._completedActions=[]},n.prototype.update=function(n){this._actions.length>0&&(this._currentAction=this._actions[0],this._currentAction.update(n),this._currentAction.isComplete(this.actor)&&(this._completedActions.push(this._actions.shift()),this._currentAction.reset()))},n}();t.ActionQueue=i})(t.Actions||(t.Actions={}));var i=t.Actions})(n.Internal||(n.Internal={}));var t=n.Internal}(ex||(ex={}));
/*
//# sourceMappingURL=Excalibur.min.js.map
*/